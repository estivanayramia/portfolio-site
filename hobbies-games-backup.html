<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <!-- Meta Tags -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="description" content="Test your reflexes and strategy with premium arcade games: Snake, System Stacker, and System Merge (2048).">
    <title>Arcade Games | Estivan Ayramia</title>
    
    <!-- Open Graph / Social Media -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="Arcade Games | Estivan Ayramia">
    <meta property="og:description" content="Premium arcade challenges: Snake, System Stacker tower game, and System Merge puzzle.">
    <meta property="og:url" content="https://estivanayramia.com/hobbies-games.html">
    
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" crossorigin>
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="/assets/css/style.css">
    <link rel="stylesheet" href="/assets/css/theme.css">
    
    <!-- Favicon -->
    <link rel="icon" href="/assets/img/icon-192.png" type="image/png">
    <link rel="apple-touch-icon" href="/assets/img/apple-touch-icon.png">
    
    <style>
        /* Game-specific styles */
        .game-container {
            min-height: 400px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        /* Snake Game Canvas */
        #snake-canvas {
            border: 3px solid currentColor;
            border-radius: 8px;
            background: #1a1a2e;
        }
        [data-theme="light"] #snake-canvas {
            background: #f5f5f5;
        }
        
        /* Whack-a-mole grid */
        .mole-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            max-width: 300px;
        }
        .mole-hole {
            width: 80px;
            height: 80px;
            background: linear-gradient(180deg, #8B4513 0%, #5D3A1A 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            border: 3px solid #3d2817;
            transition: transform 0.1s;
        }
        .mole-hole:active {
            transform: scale(0.95);
        }
        .mole {
            font-size: 40px;
            position: absolute;
            bottom: -50px;
            transition: bottom 0.15s ease-out;
            user-select: none;
        }
        .mole.active {
            bottom: 5px;
        }
        
        /* Typing test */
        .typing-display {
            font-family: 'Courier New', monospace;
            font-size: 1.25rem;
            padding: 20px;
            border-radius: 8px;
            background: rgba(0,0,0,0.2);
            min-height: 80px;
            line-height: 1.8;
            max-width: 600px;
        }
        [data-theme="light"] .typing-display {
            background: rgba(0,0,0,0.05);
        }
        .typing-display .correct {
            color: #22c55e;
        }
        .typing-display .incorrect {
            color: #ef4444;
            text-decoration: underline;
        }
        .typing-display .current {
            background: rgba(59, 130, 246, 0.5);
            border-radius: 2px;
        }
        .typing-display .pending {
            opacity: 0.5;
        }
        #typing-input {
            opacity: 0;
            position: absolute;
            pointer-events: none;
        }
        
        /* Score displays */
        .game-score {
            font-size: 1.5rem;
            font-weight: bold;
            padding: 10px 20px;
            border-radius: 8px;
            background: rgba(0,0,0,0.2);
        }
        
        /* Game selection cards */
        .game-card {
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        .game-card:hover {
            transform: translateY(-5px);
            border-color: currentColor;
        }
        
        /* Mobile touch controls for snake */
        .touch-controls {
            display: none;
            gap: 10px;
            margin-top: 20px;
        }
        @media (max-width: 768px) {
            .touch-controls {
                display: grid;
                grid-template-areas: 
                    ". up ."
                    "left . right"
                    ". down .";
                gap: 5px;
            }
        }
        .touch-btn {
            width: 60px;
            height: 60px;
            font-size: 24px;
            border-radius: 12px;
            background: rgba(0,0,0,0.3);
            border: 2px solid currentColor;
            color: inherit;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .touch-btn:active {
            background: rgba(0,0,0,0.5);
            transform: scale(0.95);
        }
        .touch-btn.up { grid-area: up; }
        .touch-btn.down { grid-area: down; }
        .touch-btn.left { grid-area: left; }
        .touch-btn.right { grid-area: right; }
        
        /* Dark mode support for this page */
        [data-theme="dark"] body {
            background-color: #212842 !important;
            color: #e1d4c2 !important;
        }
        [data-theme="dark"] header {
            background-color: rgba(33, 40, 66, 0.95) !important;
            border-color: rgba(225, 212, 194, 0.1) !important;
        }
        [data-theme="dark"] .bg-white\/50,
        [data-theme="dark"] .bg-white\/5 {
            background-color: rgba(255, 255, 255, 0.05) !important;
        }
        [data-theme="dark"] .hover\:bg-chocolate\/10:hover {
            background-color: rgba(225, 212, 194, 0.1) !important;
        }
        [data-theme="dark"] .hover\:bg-beige\/10:hover {
            background-color: rgba(225, 212, 194, 0.1) !important;
        }
        [data-theme="dark"] .border-chocolate\/10 {
            border-color: rgba(225, 212, 194, 0.1) !important;
        }
        [data-theme="dark"] .border-beige\/10 {
            border-color: rgba(225, 212, 194, 0.1) !important;
        }
        [data-theme="dark"] .text-chocolate {
            color: #e1d4c2 !important;
        }
        [data-theme="dark"] .bg-chocolate {
            background-color: #e1d4c2 !important;
        }
        [data-theme="dark"] .text-beige {
            color: #e1d4c2 !important;
        }
        [data-theme="dark"] .text-indigodeep {
            color: #212842 !important;
        }
    </style>
</head>
<body class="bg-beige text-chocolate min-h-screen transition-colors duration-300">
    <!-- Fixed Header -->
    <header class="fixed top-0 left-0 right-0 z-50 bg-beige/95 backdrop-blur-sm border-b border-chocolate/10">
        <div class="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
            <a href="/index.html" class="flex items-center gap-2 hover:opacity-80 transition-opacity">
                <img src="/assets/img/logo-ea.webp" alt="EA Logo" class="w-8 h-8 object-contain" width="300" height="264" loading="eager">
                <span class="font-semibold">Estivan Ayramia</span>
            </a>
            <div class="flex items-center gap-4">
                <a href="/contact.html" class="text-sm font-medium hover:underline">Contact</a>
                <button id="theme-toggle" class="text-base font-medium text-beige bg-indigodeep border border-white/20 p-2 rounded-full hover:bg-chocolate transition-colors dark:bg-indigodeep dark:text-beige dark:hover:bg-white dark:hover:text-indigodeep dark:border-white/20 focus:outline-none focus:ring-2 focus:ring-indigodeep focus:ring-offset-2 focus:ring-offset-beige" aria-label="Toggle theme">
                    üîÜ
                </button>
            </div>
        </div>
    </header>

    <main class="pt-20 pb-12 px-4">
        <div class="max-w-4xl mx-auto">
            <!-- Game Selection Screen -->
            <section id="game-selection" class="text-center">
                <h1 class="text-3xl md:text-4xl font-bold mb-4">Before You Go...</h1>
                <p class="text-lg opacity-80 mb-8">Want to play a quick game? Pick one below, or skip to hobbies!</p>
                
                <div class="grid md:grid-cols-3 gap-6 mb-8">
                    <!-- Snake Game -->
                    <div class="game-card bg-white/50 rounded-xl p-6" onclick="startGame('snake')">
                        <div class="text-5xl mb-4">üêç</div>
                        <h3 class="text-xl font-bold mb-2">Snake</h3>
                        <p class="text-sm opacity-70">Classic snake game. Eat food, grow longer, don't hit walls!</p>
                    </div>
                    
                    <!-- Whack-a-Mole -->
                    <div class="game-card bg-white/50 rounded-xl p-6" onclick="startGame('mole')">
                        <div class="text-5xl mb-4">ü¶î</div>
                        <h3 class="text-xl font-bold mb-2">Whack-a-Mole</h3>
                        <p class="text-sm opacity-70">Click the moles before they hide! 30 seconds, how many can you get?</p>
                    </div>
                    
                    <!-- Typing Test -->
                    <div class="game-card bg-white/50 rounded-xl p-6" onclick="startGame('typing')">
                        <div class="text-5xl mb-4">‚å®Ô∏è</div>
                        <h3 class="text-xl font-bold mb-2">Typing Speed</h3>
                        <p class="text-sm opacity-70">Test your typing speed! How fast can you type?</p>
                    </div>
                </div>
                
                <a href="/hobbies.html" class="inline-flex items-center gap-2 px-6 py-3 bg-chocolate text-beige rounded-full font-medium hover:opacity-90 transition-opacity">
                    Skip to Hobbies
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/></svg>
                </a>
            </section>

            <!-- Snake Game Screen -->
            <section id="snake-game" class="hidden text-center">
                <div class="flex items-center justify-between mb-6">
                    <button onclick="backToSelection()" class="flex items-center gap-2 hover:opacity-80">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg>
                        Back
                    </button>
                    <h2 class="text-2xl font-bold">üêç Snake</h2>
                    <div class="game-score">Score: <span id="snake-score">0</span></div>
                </div>
                
                <div class="game-container">
                    <canvas id="snake-canvas" width="400" height="400"></canvas>
                    <div class="touch-controls">
                        <button class="touch-btn up" onclick="setSnakeDirection('up')">‚Üë</button>
                        <button class="touch-btn left" onclick="setSnakeDirection('left')">‚Üê</button>
                        <button class="touch-btn right" onclick="setSnakeDirection('right')">‚Üí</button>
                        <button class="touch-btn down" onclick="setSnakeDirection('down')">‚Üì</button>
                    </div>
                    <p class="mt-4 text-sm opacity-70">Use arrow keys or WASD to move</p>
                    <button id="snake-start" onclick="initSnake()" class="mt-4 px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">
                        Start Game
                    </button>
                </div>
            </section>

            <!-- Whack-a-Mole Screen -->
            <section id="mole-game" class="hidden text-center">
                <div class="flex items-center justify-between mb-6">
                    <button onclick="backToSelection()" class="flex items-center gap-2 hover:opacity-80">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg>
                        Back
                    </button>
                    <h2 class="text-2xl font-bold">ü¶î Whack-a-Mole</h2>
                    <div class="flex gap-4">
                        <div class="game-score">Score: <span id="mole-score">0</span></div>
                        <div class="game-score">Time: <span id="mole-time">30</span>s</div>
                    </div>
                </div>
                
                <div class="game-container">
                    <div class="mole-grid" id="mole-grid">
                        <!-- Generated by JS -->
                    </div>
                    <button id="mole-start" onclick="initMole()" class="mt-6 px-6 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 transition-colors">
                        Start Game
                    </button>
                </div>
            </section>

            <!-- Typing Test Screen -->
            <section id="typing-game" class="hidden text-center">
                <div class="flex items-center justify-between mb-6">
                    <button onclick="backToSelection()" class="flex items-center gap-2 hover:opacity-80">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg>
                        Back
                    </button>
                    <h2 class="text-2xl font-bold">‚å®Ô∏è Typing Test</h2>
                    <div class="flex gap-4">
                        <div class="game-score"><span id="typing-wpm">0</span> WPM</div>
                        <div class="game-score"><span id="typing-accuracy">100</span>%</div>
                    </div>
                </div>
                
                <div class="game-container">
                    <div class="typing-display mb-4 text-left" id="typing-display" onclick="focusTypingInput()">
                        Click here and start typing...
                    </div>
                    <input type="text" id="typing-input" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
                    <div class="flex gap-4 mt-4">
                        <button onclick="initTyping()" class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                            New Text
                        </button>
                    </div>
                    <p class="mt-4 text-sm opacity-70">Click the text box and start typing!</p>
                </div>
            </section>

            <!-- Game Over Modal -->
            <div id="game-over-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden items-center justify-center z-50">
                <div class="bg-beige dark:bg-indigodeep rounded-2xl p-8 max-w-sm mx-4 text-center shadow-2xl">
                    <div class="text-6xl mb-4" id="modal-emoji">üéÆ</div>
                    <h3 class="text-2xl font-bold mb-2" id="modal-title">Game Over!</h3>
                    <p class="text-lg mb-6" id="modal-message">Your score: 0</p>
                    <div class="flex gap-4 justify-center">
                        <button onclick="restartCurrentGame()" class="px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">
                            Play Again
                        </button>
                        <button onclick="closeModal()" class="px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors">
                            Back
                        </button>
                        <a href="/hobbies.html" class="px-6 py-2 bg-chocolate text-beige rounded-lg hover:opacity-90 transition-opacity">
                            Hobbies
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="border-t border-chocolate/10 py-6 px-4">
        <div class="max-w-6xl mx-auto flex flex-col md:flex-row items-center justify-between gap-4 text-sm opacity-70">
            <a href="/index.html" class="flex items-center gap-2 hover:opacity-80 transition-opacity">
                <img src="/assets/img/logo-ea.webp" alt="EA Logo" class="w-6 h-6 object-contain" width="300" height="264" loading="lazy">
                <span>Estivan Ayramia</span>
            </a>
            <div class="flex gap-6">
                <a href="/contact.html" class="hover:underline">Contact</a>
                <a href="/privacy.html" class="hover:underline">Privacy</a>
                <a href="/humans.txt" class="hover:underline">Humans.txt</a>
            </div>
            <p>¬© 2025 Estivan Ayramia</p>
        </div>
    </footer>

    <script>
        // Theme Toggle
        const themeToggle = document.getElementById('theme-toggle');
        const html = document.documentElement;
        
        // Check saved preference or system preference
        const savedTheme = localStorage.getItem('theme');
        const systemDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        
        if (savedTheme) {
            html.setAttribute('data-theme', savedTheme);
        } else if (!systemDark) {
            html.setAttribute('data-theme', 'light');
        } else {
            html.setAttribute('data-theme', 'dark');
        }
        
        // Set initial icon
        const currentTheme = html.getAttribute('data-theme');
        themeToggle.innerHTML = currentTheme === 'dark' ? 'üîÜ' : 'üåô';
        
        themeToggle.addEventListener('click', () => {
            const current = html.getAttribute('data-theme');
            const next = current === 'dark' ? 'light' : 'dark';
            html.setAttribute('data-theme', next);
            localStorage.setItem('theme', next);
            
            // Update button icon
            themeToggle.innerHTML = next === 'dark' ? 'üîÜ' : 'üåô';
        });

        // Current game tracking
        let currentGame = null;

        function startGame(game) {
            currentGame = game;
            document.getElementById('game-selection').classList.add('hidden');
            document.getElementById(`${game}-game`).classList.remove('hidden');
            
            if (game === 'mole') {
                createMoleGrid();
            } else if (game === 'typing') {
                initTyping();
            }
        }

        function backToSelection() {
            // Stop any running games
            if (snakeInterval) clearInterval(snakeInterval);
            if (moleInterval) clearInterval(moleInterval);
            if (moleTimerInterval) clearInterval(moleTimerInterval);
            
            document.querySelectorAll('section[id$="-game"]').forEach(s => s.classList.add('hidden'));
            document.getElementById('game-selection').classList.remove('hidden');
            currentGame = null;
        }

        function showGameOver(emoji, title, message) {
            document.getElementById('modal-emoji').textContent = emoji;
            document.getElementById('modal-title').textContent = title;
            document.getElementById('modal-message').textContent = message;
            document.getElementById('game-over-modal').classList.remove('hidden');
            document.getElementById('game-over-modal').classList.add('flex');
        }

        function closeModal() {
            document.getElementById('game-over-modal').classList.add('hidden');
            document.getElementById('game-over-modal').classList.remove('flex');
            backToSelection();
        }

        function restartCurrentGame() {
            document.getElementById('game-over-modal').classList.add('hidden');
            document.getElementById('game-over-modal').classList.remove('flex');
            if (currentGame === 'snake') initSnake();
            else if (currentGame === 'mole') initMole();
            else if (currentGame === 'typing') initTyping();
        }

        // ========== SNAKE GAME ==========
        const snakeCanvas = document.getElementById('snake-canvas');
        const snakeCtx = snakeCanvas.getContext('2d');
        const gridSize = 20;
        const tileCount = snakeCanvas.width / gridSize;
        
        let snake = [];
        let food = {};
        let direction = { x: 0, y: 0 };
        let nextDirection = { x: 0, y: 0 };
        let snakeScore = 0;
        let snakeInterval = null;
        let gameRunning = false;

        function initSnake() {
            snake = [
                { x: 10, y: 10 },
                { x: 9, y: 10 },
                { x: 8, y: 10 }
            ];
            direction = { x: 1, y: 0 };
            nextDirection = { x: 1, y: 0 };
            snakeScore = 0;
            document.getElementById('snake-score').textContent = '0';
            placeFood();
            
            if (snakeInterval) clearInterval(snakeInterval);
            gameRunning = true;
            snakeInterval = setInterval(gameLoop, 100);
            document.getElementById('snake-start').textContent = 'Restart';
        }

        function placeFood() {
            food = {
                x: Math.floor(Math.random() * tileCount),
                y: Math.floor(Math.random() * tileCount)
            };
            // Make sure food doesn't spawn on snake
            for (let segment of snake) {
                if (segment.x === food.x && segment.y === food.y) {
                    placeFood();
                    return;
                }
            }
        }

        function gameLoop() {
            if (!gameRunning) return;
            
            direction = { ...nextDirection };
            
            // Move snake
            const head = { x: snake[0].x + direction.x, y: snake[0].y + direction.y };
            
            // Check wall collision
            if (head.x < 0 || head.x >= tileCount || head.y < 0 || head.y >= tileCount) {
                gameOver();
                return;
            }
            
            // Check self collision
            for (let segment of snake) {
                if (head.x === segment.x && head.y === segment.y) {
                    gameOver();
                    return;
                }
            }
            
            snake.unshift(head);
            
            // Check food collision
            if (head.x === food.x && head.y === food.y) {
                snakeScore += 10;
                document.getElementById('snake-score').textContent = snakeScore;
                placeFood();
            } else {
                snake.pop();
            }
            
            draw();
        }

        function draw() {
            const isDark = html.getAttribute('data-theme') === 'dark';
            
            // Clear canvas
            snakeCtx.fillStyle = isDark ? '#1a1a2e' : '#f5f5f5';
            snakeCtx.fillRect(0, 0, snakeCanvas.width, snakeCanvas.height);
            
            // Draw grid lines (subtle)
            snakeCtx.strokeStyle = isDark ? 'rgba(255,255,255,0.05)' : 'rgba(0,0,0,0.05)';
            for (let i = 0; i <= tileCount; i++) {
                snakeCtx.beginPath();
                snakeCtx.moveTo(i * gridSize, 0);
                snakeCtx.lineTo(i * gridSize, snakeCanvas.height);
                snakeCtx.stroke();
                snakeCtx.beginPath();
                snakeCtx.moveTo(0, i * gridSize);
                snakeCtx.lineTo(snakeCanvas.width, i * gridSize);
                snakeCtx.stroke();
            }
            
            // Draw snake
            snake.forEach((segment, index) => {
                const gradient = snakeCtx.createRadialGradient(
                    segment.x * gridSize + gridSize/2,
                    segment.y * gridSize + gridSize/2,
                    0,
                    segment.x * gridSize + gridSize/2,
                    segment.y * gridSize + gridSize/2,
                    gridSize/2
                );
                
                if (index === 0) {
                    // Head - brighter
                    gradient.addColorStop(0, '#22c55e');
                    gradient.addColorStop(1, '#16a34a');
                } else {
                    // Body - gradient based on position
                    const brightness = Math.max(0.4, 1 - (index * 0.05));
                    gradient.addColorStop(0, `rgba(34, 197, 94, ${brightness})`);
                    gradient.addColorStop(1, `rgba(22, 163, 74, ${brightness})`);
                }
                
                snakeCtx.fillStyle = gradient;
                snakeCtx.beginPath();
                snakeCtx.roundRect(
                    segment.x * gridSize + 1,
                    segment.y * gridSize + 1,
                    gridSize - 2,
                    gridSize - 2,
                    4
                );
                snakeCtx.fill();
                
                // Draw eyes on head
                if (index === 0) {
                    snakeCtx.fillStyle = 'white';
                    const eyeSize = 4;
                    const eyeOffset = 5;
                    
                    if (direction.x === 1) { // Right
                        snakeCtx.beginPath();
                        snakeCtx.arc(segment.x * gridSize + 14, segment.y * gridSize + 6, eyeSize, 0, Math.PI * 2);
                        snakeCtx.arc(segment.x * gridSize + 14, segment.y * gridSize + 14, eyeSize, 0, Math.PI * 2);
                        snakeCtx.fill();
                    } else if (direction.x === -1) { // Left
                        snakeCtx.beginPath();
                        snakeCtx.arc(segment.x * gridSize + 6, segment.y * gridSize + 6, eyeSize, 0, Math.PI * 2);
                        snakeCtx.arc(segment.x * gridSize + 6, segment.y * gridSize + 14, eyeSize, 0, Math.PI * 2);
                        snakeCtx.fill();
                    } else if (direction.y === -1) { // Up
                        snakeCtx.beginPath();
                        snakeCtx.arc(segment.x * gridSize + 6, segment.y * gridSize + 6, eyeSize, 0, Math.PI * 2);
                        snakeCtx.arc(segment.x * gridSize + 14, segment.y * gridSize + 6, eyeSize, 0, Math.PI * 2);
                        snakeCtx.fill();
                    } else { // Down
                        snakeCtx.beginPath();
                        snakeCtx.arc(segment.x * gridSize + 6, segment.y * gridSize + 14, eyeSize, 0, Math.PI * 2);
                        snakeCtx.arc(segment.x * gridSize + 14, segment.y * gridSize + 14, eyeSize, 0, Math.PI * 2);
                        snakeCtx.fill();
                    }
                }
            });
            
            // Draw food (apple)
            snakeCtx.fillStyle = '#ef4444';
            snakeCtx.beginPath();
            snakeCtx.arc(
                food.x * gridSize + gridSize/2,
                food.y * gridSize + gridSize/2 + 2,
                gridSize/2 - 3,
                0,
                Math.PI * 2
            );
            snakeCtx.fill();
            
            // Apple stem
            snakeCtx.fillStyle = '#84cc16';
            snakeCtx.fillRect(food.x * gridSize + gridSize/2 - 2, food.y * gridSize + 2, 4, 6);
        }

        function gameOver() {
            gameRunning = false;
            clearInterval(snakeInterval);
            
            let message = `Final Score: ${snakeScore}`;
            let emoji = 'üêç';
            if (snakeScore >= 100) {
                emoji = 'üèÜ';
                message += ' - Amazing!';
            } else if (snakeScore >= 50) {
                emoji = 'üåü';
                message += ' - Great job!';
            }
            
            showGameOver(emoji, 'Game Over!', message);
        }

        function setSnakeDirection(dir) {
            if (!gameRunning) return;
            
            const opposites = { up: 'down', down: 'up', left: 'right', right: 'left' };
            const currentDir = direction.y === -1 ? 'up' : direction.y === 1 ? 'down' : direction.x === -1 ? 'left' : 'right';
            
            if (dir === opposites[currentDir]) return;
            
            switch(dir) {
                case 'up': nextDirection = { x: 0, y: -1 }; break;
                case 'down': nextDirection = { x: 0, y: 1 }; break;
                case 'left': nextDirection = { x: -1, y: 0 }; break;
                case 'right': nextDirection = { x: 1, y: 0 }; break;
            }
        }

        document.addEventListener('keydown', (e) => {
            if (currentGame !== 'snake' || !gameRunning) return;
            
            switch(e.key) {
                case 'ArrowUp':
                case 'w':
                case 'W':
                    e.preventDefault();
                    setSnakeDirection('up');
                    break;
                case 'ArrowDown':
                case 's':
                case 'S':
                    e.preventDefault();
                    setSnakeDirection('down');
                    break;
                case 'ArrowLeft':
                case 'a':
                case 'A':
                    e.preventDefault();
                    setSnakeDirection('left');
                    break;
                case 'ArrowRight':
                case 'd':
                case 'D':
                    e.preventDefault();
                    setSnakeDirection('right');
                    break;
            }
        });

        // ========== WHACK-A-MOLE ==========
        let moleScore = 0;
        let moleTime = 30;
        let moleInterval = null;
        let moleTimerInterval = null;
        let activeMole = null;

        function createMoleGrid() {
            const grid = document.getElementById('mole-grid');
            grid.innerHTML = '';
            
            for (let i = 0; i < 9; i++) {
                const hole = document.createElement('div');
                hole.className = 'mole-hole';
                hole.dataset.index = i;
                hole.innerHTML = '<span class="mole">ü¶î</span>';
                hole.addEventListener('click', whackMole);
                grid.appendChild(hole);
            }
        }

        function initMole() {
            moleScore = 0;
            moleTime = 30;
            document.getElementById('mole-score').textContent = '0';
            document.getElementById('mole-time').textContent = '30';
            document.getElementById('mole-start').textContent = 'Restart';
            
            if (moleInterval) clearInterval(moleInterval);
            if (moleTimerInterval) clearInterval(moleTimerInterval);
            
            // Start spawning moles
            moleInterval = setInterval(spawnMole, 800);
            
            // Start countdown
            moleTimerInterval = setInterval(() => {
                moleTime--;
                document.getElementById('mole-time').textContent = moleTime;
                
                if (moleTime <= 0) {
                    endMoleGame();
                }
            }, 1000);
            
            spawnMole();
        }

        function spawnMole() {
            // Hide current mole
            if (activeMole !== null) {
                const currentMole = document.querySelector(`.mole-hole[data-index="${activeMole}"] .mole`);
                if (currentMole) currentMole.classList.remove('active');
            }
            
            // Pick random hole
            activeMole = Math.floor(Math.random() * 9);
            const mole = document.querySelector(`.mole-hole[data-index="${activeMole}"] .mole`);
            if (mole) mole.classList.add('active');
            
            // Auto-hide after delay
            setTimeout(() => {
                if (mole && mole.classList.contains('active')) {
                    mole.classList.remove('active');
                }
            }, 700);
        }

        function whackMole(e) {
            const hole = e.currentTarget;
            const mole = hole.querySelector('.mole');
            
            if (mole && mole.classList.contains('active')) {
                moleScore += 10;
                document.getElementById('mole-score').textContent = moleScore;
                mole.classList.remove('active');
                
                // Visual feedback
                hole.style.transform = 'scale(0.9)';
                setTimeout(() => hole.style.transform = '', 100);
                
                // Bonus: spawn faster as score increases
                if (moleScore % 50 === 0 && moleInterval) {
                    clearInterval(moleInterval);
                    const speed = Math.max(400, 800 - (moleScore / 50) * 100);
                    moleInterval = setInterval(spawnMole, speed);
                }
            }
        }

        function endMoleGame() {
            clearInterval(moleInterval);
            clearInterval(moleTimerInterval);
            
            // Hide any active mole
            const activeMoleEl = document.querySelector('.mole.active');
            if (activeMoleEl) activeMoleEl.classList.remove('active');
            
            let emoji = 'ü¶î';
            let title = 'Time\'s Up!';
            let message = `You whacked ${moleScore / 10} moles! Score: ${moleScore}`;
            
            if (moleScore >= 200) {
                emoji = 'üèÜ';
                title = 'Incredible!';
            } else if (moleScore >= 100) {
                emoji = 'üåü';
                title = 'Great Job!';
            }
            
            showGameOver(emoji, title, message);
        }

        // ========== TYPING TEST ==========
        const typingTexts = [
            "The quick brown fox jumps over the lazy dog.",
            "Pack my box with five dozen liquor jugs.",
            "How vexingly quick daft zebras jump!",
            "Sphinx of black quartz, judge my vow.",
            "Two driven jocks help fax my big quiz.",
            "The five boxing wizards jump quickly.",
            "Jackdaws love my big sphinx of quartz.",
            "Crazy Frederick bought many very exquisite opal jewels.",
            "We promptly judged antique ivory buckles for the next prize.",
            "A mad boxer shot a quick, gloved jab to the jaw of his dizzy opponent."
        ];

        let typingText = '';
        let typingIndex = 0;
        let typingStartTime = null;
        let typingErrors = 0;
        let typingCompleted = false;

        function initTyping() {
            typingText = typingTexts[Math.floor(Math.random() * typingTexts.length)];
            typingIndex = 0;
            typingStartTime = null;
            typingErrors = 0;
            typingCompleted = false;
            
            document.getElementById('typing-wpm').textContent = '0';
            document.getElementById('typing-accuracy').textContent = '100';
            
            renderTypingDisplay();
            
            const input = document.getElementById('typing-input');
            input.value = '';
            input.focus();
        }

        function renderTypingDisplay() {
            const display = document.getElementById('typing-display');
            let html = '';
            
            for (let i = 0; i < typingText.length; i++) {
                let char = typingText[i];
                if (char === ' ') char = '&nbsp;';
                
                if (i < typingIndex) {
                    html += `<span class="correct">${char}</span>`;
                } else if (i === typingIndex) {
                    html += `<span class="current">${char}</span>`;
                } else {
                    html += `<span class="pending">${char}</span>`;
                }
            }
            
            display.innerHTML = html;
        }

        function focusTypingInput() {
            document.getElementById('typing-input').focus();
        }

        document.getElementById('typing-input').addEventListener('keydown', (e) => {
            if (typingCompleted) return;
            
            // Start timer on first keypress
            if (!typingStartTime && e.key.length === 1) {
                typingStartTime = Date.now();
            }
            
            if (e.key === typingText[typingIndex]) {
                typingIndex++;
                renderTypingDisplay();
                updateTypingStats();
                
                if (typingIndex >= typingText.length) {
                    typingCompleted = true;
                    showTypingResults();
                }
            } else if (e.key.length === 1) {
                typingErrors++;
                updateTypingStats();
                
                // Visual feedback for error
                const display = document.getElementById('typing-display');
                display.style.animation = 'shake 0.2s';
                setTimeout(() => display.style.animation = '', 200);
            }
        });

        function updateTypingStats() {
            if (!typingStartTime) return;
            
            const elapsed = (Date.now() - typingStartTime) / 1000 / 60; // minutes
            const wordsTyped = typingIndex / 5; // standard: 5 chars = 1 word
            const wpm = Math.round(wordsTyped / elapsed) || 0;
            
            const totalAttempts = typingIndex + typingErrors;
            const accuracy = totalAttempts > 0 ? Math.round((typingIndex / totalAttempts) * 100) : 100;
            
            document.getElementById('typing-wpm').textContent = wpm;
            document.getElementById('typing-accuracy').textContent = accuracy;
        }

        function showTypingResults() {
            const elapsed = (Date.now() - typingStartTime) / 1000;
            const wpm = document.getElementById('typing-wpm').textContent;
            const accuracy = document.getElementById('typing-accuracy').textContent;
            
            let emoji = '‚å®Ô∏è';
            let title = 'Complete!';
            
            if (parseInt(wpm) >= 80) {
                emoji = 'üèÜ';
                title = 'Speed Demon!';
            } else if (parseInt(wpm) >= 50) {
                emoji = 'üåü';
                title = 'Nice Speed!';
            }
            
            showGameOver(emoji, title, `${wpm} WPM with ${accuracy}% accuracy in ${elapsed.toFixed(1)}s`);
        }

        // Add shake animation
        const style = document.createElement('style');
        style.textContent = `
            @keyframes shake {
                0%, 100% { transform: translateX(0); }
                25% { transform: translateX(-5px); }
                75% { transform: translateX(5px); }
            }
        `;
        document.head.appendChild(style);

        // Initial canvas draw
        draw();
    </script>
</body>
</html>
