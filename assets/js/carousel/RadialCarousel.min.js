function b(n,t,e){let i=Number(n),s=Number(t),r=Number(e);return Number.isFinite(i)?Math.max(s,Math.min(r,i)):s}function x(n,t){let e=null;return function(...s){e&&clearTimeout(e),e=setTimeout(()=>{e=null,n.apply(this,s)},Math.max(0,Number(t)||0))}}function u(n){try{return window.matchMedia?window.matchMedia(String(n)):{matches:!1}}catch(t){return{matches:!1}}}function v(){return u("(prefers-reduced-motion: reduce)").matches}function g(){try{return typeof CSS!="undefined"&&typeof CSS.supports=="function"&&(CSS.supports("transform-style: preserve-3d")||CSS.supports("perspective: 1px"))}catch(n){return!1}}function E(n,t,e){if(!n||!t)return;let s=v()?"auto":e;try{let r=n.getBoundingClientRect(),o=t.getBoundingClientRect(),a=r.left+r.width/2,l=o.left+o.width/2-a;n.scrollBy({left:l,behavior:s})}catch(r){try{t.scrollIntoView({behavior:s,inline:"center",block:"nearest"})}catch(o){}}}function _(n=10){try{"vibrate"in navigator&&typeof navigator.vibrate=="function"&&navigator.vibrate(Math.max(0,Number(n)||0))}catch(t){}}var C=Object.freeze({radius:450,autoRotate:!1,autoRotateMs:4500,rotationSpeed:600,minItems:4,enableTouch:!0,matchPath:!1,clickToCenter:!1,linkAware:!1,startIndex:0}),h=Object.freeze({viewport:".carousel-radial__viewport",track:".carousel-radial__track",item:".carousel-radial__item",controls:".carousel-radial__controls",status:".carousel-radial__status",prev:".carousel-radial__btn--prev",next:".carousel-radial__btn--next",indicators:".carousel-radial__indicators"}),T=()=>u("(min-width: 1024px)").matches&&u("(hover: hover)").matches&&u("(pointer: fine)").matches;function d(n,t){let e=n.getAttribute(t);return e===null?null:e===""||e==="1"||e==="true"}function f(n,t){let e=n.getAttribute(t);if(e===null)return null;let i=Number(e);return Number.isFinite(i)?i:null}function k(n){try{return(n.textContent||"").trim()}catch(t){return""}}function A(n){let t=n.querySelector(".carousel-radial__title")||n.querySelector("h3")||n.querySelector("h2");return t?k(t):""}function D(n){return n.querySelector('a[href],button:not([disabled]),input:not([disabled]),select:not([disabled]),textarea:not([disabled]),[tabindex]:not([tabindex="-1"])')}function w(n,t){if("inert"in n)try{n.inert=t}catch(e){}}var y=class{constructor(t,e={}){if(this.element=t,this.options={...C,...e},this.viewport=t.querySelector(h.viewport),this.track=t.querySelector(h.track),this.items=Array.from(t.querySelectorAll(h.item)),this.controls=t.querySelector(h.controls),this.statusEl=t.querySelector(h.status),this.prevBtn=t.querySelector(h.prev),this.nextBtn=t.querySelector(h.next),this.indicators=t.querySelector(h.indicators),this._indicatorButtons=[],this.currentIndex=0,this.isAnimating=!1,this.isEnhanced3D=!1,this._angleStep=0,this._willChangeT=null,this._autoRotateT=null,this._observer=null,this._visibilityObserver=null,this._onResize=x(()=>this.refresh(),150),this._onKeyDown=i=>this._handleKeyDown(i),this._onClick=i=>this._handleClick(i),this._onPointerDown=i=>this._handlePointerDown(i),!(!this.viewport||!this.track||!this.items.length)&&this.element.getAttribute("data-carousel-init")!=="1"){this._readOptionsFromDataset(),this._angleStep=Math.PI*2/this.items.length,this._buildIndicators(),this._showControls(),this._bindEvents(),this.currentIndex=this._resolveStartIndex(),this._setActiveState({announce:!0,apply3D:!1}),this.isEnhanced3D=this._canEnhance3D(),this.isEnhanced3D&&(this.element.classList.add("carousel-radial--enhanced"),this._apply3D({animate:!1})),this.element.setAttribute("data-carousel-init","1"),this.element.classList.add("carousel-radial--ready"),this.options.autoRotate&&this._setupVisibilityObserver();try{window.addEventListener("resize",this._onResize,{passive:!0})}catch(i){window.addEventListener("resize",this._onResize)}}}_readOptionsFromDataset(){let t=f(this.element,"data-carousel-radius");t!==null&&(this.options.radius=t);let e=f(this.element,"data-carousel-rotation-speed");e!==null&&(this.options.rotationSpeed=e);let i=f(this.element,"data-carousel-min-items");i!==null&&(this.options.minItems=i);let s=d(this.element,"data-carousel-autorotate");s!==null&&(this.options.autoRotate=s);let r=f(this.element,"data-carousel-autorotate-ms");r!==null&&(this.options.autoRotateMs=r);let o=d(this.element,"data-carousel-enable-touch");o!==null&&(this.options.enableTouch=o);let a=d(this.element,"data-carousel-match-path");a!==null&&(this.options.matchPath=a);let c=d(this.element,"data-carousel-click-to-center");c!==null&&(this.options.clickToCenter=c);let l=d(this.element,"data-carousel-link-aware");l!==null&&(this.options.linkAware=l);let p=f(this.element,"data-carousel-start-index");p!==null&&(this.options.startIndex=p)}_resolveStartIndex(){let t=this.items.length-1,e=b(this.options.startIndex,0,t);if(!this.options.matchPath)return e;try{let s=new URL(window.location.href).pathname.replace(/\/+$/,""),r=this.items;for(let o=0;o<r.length;o++){let a=r[o].querySelector("a[href]");if(!a)continue;let c=a.getAttribute("href")||"";if(!c.startsWith("/"))continue;if(c.replace(/\/+$/,"")===s)return o}}catch(i){}return e}_canEnhance3D(){return v()||!g()||!T()?!1:this.items.length>=this.options.minItems}_showControls(){if(this.controls)try{this.controls.style.display="flex"}catch(t){}}_buildIndicators(){if(this.indicators){try{this.indicators.innerHTML=""}catch(t){for(;this.indicators.firstChild;)this.indicators.removeChild(this.indicators.firstChild)}this._indicatorButtons=this.items.map((t,e)=>{let i=document.createElement("button");return i.type="button",i.setAttribute("role","tab"),i.setAttribute("aria-label",`Go to item ${e+1}`),i.className="carousel-radial__indicator",i.addEventListener("click",()=>{this.goTo(e,{behavior:"smooth",focus:!1})}),this.indicators.appendChild(i),i}),this._syncIndicators()}}_syncIndicators(){this._indicatorButtons.length&&this._indicatorButtons.forEach((t,e)=>{let i=e===this.currentIndex;t.classList.toggle("is-active",i);try{t.setAttribute("aria-selected",i?"true":"false"),t.tabIndex=i?0:-1}catch(s){}})}_bindEvents(){this.prevBtn&&this.prevBtn.addEventListener("click",t=>{t.preventDefault(),this.prev({behavior:"smooth"})}),this.nextBtn&&this.nextBtn.addEventListener("click",t=>{t.preventDefault(),this.next({behavior:"smooth"})}),this.element.addEventListener("keydown",this._onKeyDown),(this.options.clickToCenter||this.options.linkAware)&&this.element.addEventListener("click",this._onClick),this.options.enableTouch&&this.viewport.addEventListener("pointerdown",this._onPointerDown),this._setupScrollObserver()}_setupScrollObserver(){if("IntersectionObserver"in window&&this.track)try{this._observer=new IntersectionObserver(t=>{if(this.isEnhanced3D)return;let e=null;for(let s of t)s.isIntersecting&&(!e||s.intersectionRatio>e.intersectionRatio)&&(e=s);if(!e)return;let i=this.items.indexOf(e.target);i<0||i===this.currentIndex||(this.currentIndex=i,this._setActiveState({announce:!0,apply3D:!1}))},{root:this.track,threshold:[.5,.6,.7,.8]}),this.items.forEach(t=>{try{this._observer&&this._observer.observe(t)}catch(e){}})}catch(t){this._observer=null}}_setupVisibilityObserver(){if(!("IntersectionObserver"in window)){this.startAutoRotate();return}try{this._visibilityObserver=new IntersectionObserver(t=>{let e=t&&t[0];e&&(e.isIntersecting?this.startAutoRotate():this.stopAutoRotate())},{threshold:.5}),this._visibilityObserver.observe(this.element)}catch(t){this._visibilityObserver=null,this.startAutoRotate()}}_handleKeyDown(t){if(!t)return;let e=t.target instanceof HTMLElement?t.target:null;if(e&&/^(input|textarea|select)$/i.test(e.tagName))return;let i=t.key;if(i==="ArrowLeft"){t.preventDefault(),this.prev({behavior:"smooth",focus:!0});return}if(i==="ArrowRight"){t.preventDefault(),this.next({behavior:"smooth",focus:!0});return}if(i==="Home"){t.preventDefault(),this.goTo(0,{behavior:"smooth",focus:!0});return}i==="End"&&(t.preventDefault(),this.goTo(this.items.length-1,{behavior:"smooth",focus:!0}))}_handleClick(t){let e=t.target instanceof Element?t.target.closest(h.item):null;if(!e)return;let i=this.items.indexOf(e);if(i<0)return;let s=i===this.currentIndex,r=t.target instanceof Element?t.target.closest("a[href]"):null;if(this.options.linkAware&&r&&!s){t.preventDefault(),this.goTo(i,{behavior:"smooth",focus:!1});return}this.options.clickToCenter&&!s&&this.goTo(i,{behavior:"smooth",focus:!1})}_handlePointerDown(t){if(!t||t.button!==0||!this.isEnhanced3D)return;try{t.preventDefault()}catch(a){}let e=t.clientX,i=!1,s=a=>{let c=a.clientX-e;i||Math.abs(c)<42||(i=!0,c>0?this.prev({behavior:"smooth"}):this.next({behavior:"smooth"}),o())},r=()=>o(),o=()=>{try{window.removeEventListener("pointermove",s),window.removeEventListener("pointerup",r),window.removeEventListener("pointercancel",r)}catch(a){}};try{window.addEventListener("pointermove",s,{passive:!0}),window.addEventListener("pointerup",r,{passive:!0}),window.addEventListener("pointercancel",r,{passive:!0})}catch(a){window.addEventListener("pointermove",s),window.addEventListener("pointerup",r),window.addEventListener("pointercancel",r)}}refresh(){let t=this._canEnhance3D();if(t&&!this.isEnhanced3D){this.isEnhanced3D=!0,this.element.classList.add("carousel-radial--enhanced"),this._apply3D({animate:!1});return}if(!t&&this.isEnhanced3D){this.isEnhanced3D=!1,this.element.classList.remove("carousel-radial--enhanced"),this._clear3DStyles(),this._setActiveState({announce:!1,apply3D:!1});return}this.isEnhanced3D&&this._apply3D({animate:!1})}_clear3DStyles(){if(this.items.forEach(t=>{try{t.style.transform="",t.style.transition="",t.style.willChange="",t.style.filter="",t.style.opacity=""}catch(e){}try{t.removeAttribute("aria-hidden"),t.removeAttribute("tabindex")}catch(e){}w(t,!1),t.classList.remove("carousel-radial__item--active")}),this.viewport)try{this.viewport.style.height=""}catch(t){}}_apply3D({animate:t}){if(!this.viewport||!this.track)return;let e=v()?0:t?this.options.rotationSpeed:0,i="cubic-bezier(0.4, 0, 0.2, 1)";try{let s=Math.max(0,...this.items.map(r=>{try{return Math.ceil(r.getBoundingClientRect().height)}catch(o){return 0}}));s&&(this.viewport.style.height=`${s}px`)}catch(s){}this.items.forEach((s,r)=>{let o=(r-this.currentIndex)*this._angleStep,a=Math.sin(o)*this.options.radius,c=Math.cos(o)*this.options.radius,l=-o*180/Math.PI,p=`translate(-50%, -50%) translate3d(${a.toFixed(2)}px, 0px, ${c.toFixed(2)}px) rotateY(${l.toFixed(2)}deg)`;try{e>0?(s.style.transition=`transform ${e}ms ${i}, opacity ${e}ms ease, filter ${e}ms ease`,s.style.willChange="transform, opacity, filter"):s.style.transition="none",s.style.transform=p}catch(S){}let m=r===this.currentIndex;s.classList.toggle("carousel-radial__item--active",m);try{s.setAttribute("aria-hidden",m?"false":"true"),s.tabIndex=m?0:-1}catch(S){}w(s,!m)}),this._setActiveState({announce:!0,apply3D:!1}),this._willChangeT&&window.clearTimeout(this._willChangeT),e>0&&(this._willChangeT=window.setTimeout(()=>{this.items.forEach(s=>{try{s.style.willChange=""}catch(r){}}),this._willChangeT=null},e+40))}_setActiveState({announce:t,apply3D:e}){this.isEnhanced3D||this.items.forEach((i,s)=>{i.classList.toggle("carousel-radial__item--active",s===this.currentIndex),w(i,!1);try{i.removeAttribute("aria-hidden"),i.removeAttribute("tabindex")}catch(r){}}),this._syncIndicators(),t&&this._announce(),e&&this.isEnhanced3D&&this._apply3D({animate:!0})}_announce(){if(!this.statusEl)return;let t=this.items[this.currentIndex],e=t?A(t):"",i=e?`Item ${this.currentIndex+1} of ${this.items.length}: ${e}`:`Item ${this.currentIndex+1} of ${this.items.length}`;try{this.statusEl.textContent=i}catch(s){}}goTo(t,e={}){let i=b(t,0,this.items.length-1),s=e.behavior||"auto",r=!!e.focus;if(i===this.currentIndex){if(r){let o=this.items[this.currentIndex],a=D(o)||o;try{a.focus({preventScroll:!0})}catch(c){}}return}if(this.currentIndex=i,this.isEnhanced3D)this._apply3D({animate:!0});else if(this.track){let o=this.items[this.currentIndex];E(this.track,o,s),this._setActiveState({announce:!0,apply3D:!1})}if(r){let o=this.items[this.currentIndex],a=D(o)||o;try{a.focus({preventScroll:!0})}catch(c){}}try{this.element.dispatchEvent(new CustomEvent("carouselrotate",{detail:{index:this.currentIndex,item:this.items[this.currentIndex]}}))}catch(o){}}next(t={}){_(10);let e=(this.currentIndex+1)%this.items.length;this.goTo(e,t)}prev(t={}){_(10);let e=(this.currentIndex-1+this.items.length)%this.items.length;this.goTo(e,t)}startAutoRotate(){if(!this.options.autoRotate||this._autoRotateT)return;let t=()=>{this._autoRotateT=window.setTimeout(()=>{this._autoRotateT=null,this.next({behavior:"smooth"}),t()},Math.max(1200,Number(this.options.autoRotateMs)||0))};t()}stopAutoRotate(){this._autoRotateT&&(window.clearTimeout(this._autoRotateT),this._autoRotateT=null)}destroy(){try{window.removeEventListener("resize",this._onResize)}catch(t){}try{this.element.removeEventListener("keydown",this._onKeyDown),this.element.removeEventListener("click",this._onClick)}catch(t){}try{this.viewport&&this.viewport.removeEventListener("pointerdown",this._onPointerDown)}catch(t){}try{this._observer&&this._observer.disconnect()}catch(t){}this._observer=null;try{this._visibilityObserver&&this._visibilityObserver.disconnect()}catch(t){}this._visibilityObserver=null,this.stopAutoRotate(),this._clear3DStyles();try{this.element.classList.remove("carousel-radial--enhanced","carousel-radial--ready"),this.element.removeAttribute("data-carousel-init")}catch(t){}}};function I(){let n=Array.from(document.querySelectorAll("[data-carousel-radial]"));n.length&&n.forEach(t=>{try{new y(t)}catch(e){}})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",I):I();export{y as default};
