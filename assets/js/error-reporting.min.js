(function(){"use strict";const n="site_error_reporting_consent",o="site_error_reporting_asked";function r(){return localStorage.getItem(n)==="true"}function l(){return localStorage.getItem(o)==="true"}function i(e){if(r())try{fetch("/api/error-report",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,timestamp:Date.now(),url:location.href,userAgent:navigator.userAgent,viewport:`${window.innerWidth}x${window.innerHeight}`,version:document.querySelector('meta[name="build-version"]')?.content||"unknown"})}).catch(()=>{})}catch{}}function s(){window.addEventListener("error",t=>{i({type:"javascript_error",message:t.message,filename:t.filename,line:t.lineno,col:t.colno,stack:t.error?.stack?.slice(0,1e3)})}),window.addEventListener("unhandledrejection",t=>{i({type:"unhandled_rejection",reason:t.reason?.toString()?.slice(0,500)})});const e=window.fetch;window.fetch=function(...t){return e.apply(this,t).catch(d=>{throw i({type:"network_error",url:t[0],message:d.message}),d})}}function a(){const e=document.createElement("div");e.id="error-reporting-consent",e.innerHTML=`
      <style>
        #error-reporting-consent {
          position: fixed;
          bottom: 20px;
          left: 20px;
          width: 380px;
          max-width: calc(100vw - 40px);
          background: rgba(33, 40, 66, 0.95);
          color: #e1d4c2;
          padding: 16px;
          box-shadow: 0 4px 20px rgba(0,0,0,0.3);
          z-index: 999998;
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
          font-size: 13px;
          line-height: 1.5;
          border-radius: 12px;
          border: 1px solid rgba(225, 212, 194, 0.1);
          animation: slideUp 0.3s ease-out;
          -webkit-backdrop-filter: blur(10px);
          backdrop-filter: blur(10px);
        }
        
        @keyframes slideUp {
          from { transform: translateY(20px); opacity: 0; }
          to { transform: translateY(0); opacity: 1; }
        }
        
        #error-reporting-consent .consent-content {
          display: flex;
          flex-direction: column;
          gap: 12px;
        }
        
        #error-reporting-consent .consent-text {
          width: 100%;
        }
        
        #error-reporting-consent .consent-title {
          font-weight: 600;
          margin-bottom: 4px;
          font-size: 14px;
          display: flex;
          align-items: center;
          gap: 8px;
        }

        #error-reporting-consent .consent-actions {
          display: flex;
          gap: 8px;
          justify-content: flex-end;
          width: 100%;
        }
        
        #error-reporting-consent button {
          padding: 10px 24px;
          border-radius: 6px;
          border: none;
          cursor: pointer;
          font-size: 14px;
          font-weight: 500;
          transition: all 0.2s;
          min-width: 80px;
        }
        
        #error-reporting-consent .accept-btn {
          background: #4a90e2;
          color: white;
        }
        
        #error-reporting-consent .accept-btn:hover {
          background: #357abd;
        }
        
        #error-reporting-consent .decline-btn {
          background: transparent;
          color: #e1d4c2;
          border: 1px solid rgba(225, 212, 194, 0.3);
        }
        
        #error-reporting-consent .decline-btn:hover {
          background: rgba(225, 212, 194, 0.1);
        }
        
        #error-reporting-consent a {
          color: #4a90e2;
          text-decoration: underline;
        }
      </style>
      
      <div class="consent-content">
        <div class="consent-text">
          <div class="consent-title">\u{1F6E0}\uFE0F Help me fix bugs?</div>
          <div class="consent-desc">
            Hey! I'm just one person trying to make this site better. If you're okay with it, I'd love to collect 
            <strong>anonymous error reports</strong> (crashes, broken links, etc.) to help me fix issues faster. 
            <strong>I'm not selling your data</strong> or tracking you\u2014just trying to improve the site. 
            Promise. <a href="/privacy" target="_blank">Privacy Policy</a>
          </div>
        </div>
        <div class="consent-actions">
          <button class="accept-btn" id="consent-accept">Sure, help out</button>
          <button class="decline-btn" id="consent-decline">No thanks</button>
        </div>
      </div>
    `,document.body.appendChild(e),document.getElementById("consent-accept").addEventListener("click",()=>{localStorage.setItem(n,"true"),localStorage.setItem(o,"true"),e.style.animation="slideUp 0.3s ease-out reverse",setTimeout(()=>e.remove(),300),s(),console.log("[Error Reporting] Enabled - Thank you for helping improve this site!")}),document.getElementById("consent-decline").addEventListener("click",()=>{localStorage.setItem(n,"false"),localStorage.setItem(o,"true"),e.style.animation="slideUp 0.3s ease-out reverse",setTimeout(()=>e.remove(),300),console.log("[Error Reporting] Disabled - Your choice has been saved.")})}function c(){if(new URLSearchParams(window.location.search).get("debug")==="1"&&!r()){a();return}r()?(s(),console.log("[Error Reporting] Active")):l()||setTimeout(a,3e3)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",c):c()})();
