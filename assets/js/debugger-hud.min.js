(()=>{var re=(m,p)=>()=>(p||m((p={exports:{}}).exports,p),p.exports);var ce=re(()=>{(function(){if(document.querySelectorAll(".savonie-panel").forEach(e=>e.remove()),document.querySelectorAll(".savonie-backdrop").forEach(e=>e.remove()),window.__SavonieHUD&&window.__SavonieHUD.close)try{window.__SavonieHUD.close()}catch(e){}window.__SavonieHUD&&window.__SavonieHUD.open;let m=window.__SavonieTelemetry;if(!m){window.Savonie||(window.Savonie=window.__SavonieHUD);try{console.error("[Diagnostics] Telemetry core missing.")}catch(e){}return}let p=window.__SavonieDiagnosticsConsent,M=document.createElement("style");M.textContent=`
  .savonie-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.28);z-index:999990}
  .savonie-panel{position:fixed;z-index:999991;background:rgba(225,212,194,.98);border:1px solid rgba(54,32,23,.15);
    box-shadow:0 18px 60px rgba(0,0,0,.25);font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;color:#212842}
  .savonie-header{display:flex;align-items:center;justify-content:space-between;gap:10px;padding:10px 12px;border-bottom:1px solid rgba(54,32,23,.12)}
  .savonie-title{font-weight:800}
  .savonie-btn{min-height:44px;border-radius:10px;border:1px solid rgba(33,40,66,.25);background:#212842;color:#fff;font-weight:700;
    padding:8px 10px;cursor:pointer}
  .savonie-btn.secondary{background:transparent;color:#362017;border:1px solid rgba(54,32,23,.22);font-weight:700}
  .savonie-tabs{display:flex;gap:8px;flex-wrap:wrap;padding:10px 12px;border-bottom:1px solid rgba(54,32,23,.12)}
  .savonie-tab{padding:8px 10px;border-radius:999px;border:1px solid rgba(33,40,66,.18);background:transparent;cursor:pointer;font-weight:700}
  .savonie-tab[aria-selected="true"]{background:#212842;color:#fff;border-color:rgba(33,40,66,.35)}
  .savonie-body{padding:12px;max-height:calc(100vh - 170px);overflow:auto}
  .savonie-kv{display:grid;grid-template-columns:160px 1fr;gap:8px 10px;font-size:13px}
  .savonie-k{opacity:.85}
  .savonie-v{word-break:break-word}
  .savonie-list{display:flex;flex-direction:column;gap:10px}
  .savonie-card{background:rgba(255,255,255,.65);border:1px solid rgba(54,32,23,.12);border-radius:12px;padding:10px}
  .savonie-mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;font-size:12px;white-space:pre-wrap;word-break:break-word}
  .savonie-row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
  .savonie-pill{font-size:12px;padding:2px 8px;border-radius:999px;border:1px solid rgba(33,40,66,.18);background:rgba(33,40,66,.06)}
  .savonie-handle{display:none}
  @media (max-width: 767px){
    .savonie-panel{left:10px;right:10px;bottom:10px;border-radius:16px}
    .savonie-handle{display:block;margin:8px auto 0 auto;width:56px;height:5px;border-radius:999px;background:rgba(33,40,66,.25)}
  }
  @media (min-width: 768px){
    .savonie-panel{right:12px;top:12px;bottom:12px;width:440px;border-radius:16px}
  }
  .savonie-panel.savonie-embedded{position:relative;inset:auto;right:auto;top:auto;bottom:auto;width:100%;max-width:none;
    background:#1a1f2e;color:#e1d4c2;border:1px solid #2a2f3e;box-shadow:none;z-index:2147483647 !important}
  .savonie-panel.savonie-embedded .savonie-header{border-bottom:1px solid #2a2f3e}
  .savonie-panel.savonie-embedded .savonie-tab{border-color:#2a2f3e;color:#e1d4c2}
  .savonie-panel.savonie-embedded .savonie-tab[aria-selected="true"]{background:#4a90e2 !important;color:#fff !important;border-color:#357abd !important}
  .savonie-panel.savonie-embedded .savonie-card{background:#111722;border-color:#2a2f3e}
  .savonie-panel.savonie-embedded .savonie-btn{background:#4a90e2;border-color:#357abd}
  .savonie-panel.savonie-embedded .savonie-btn.secondary{background:transparent;color:#e1d4c2;border-color:#2a2f3e}
  `,M.textContent+=`
  body.savonie-open #chatbase-bubble-button,
  body.savonie-open #chatbase-bubble-window,
  body.savonie-open iframe[id*="chat"],
  body.savonie-open .chatbase-bubble {
    display: none !important;
    pointer-events: none !important;
  }
  
  /* Force Interactivity */
  .savonie-panel, .savonie-panel * {
    pointer-events: auto !important;
  }
  `,document.head.appendChild(M),window.addEventListener("click",e=>{var t;((t=e.target.classList)!=null&&t.contains("savonie-tab")||e.target.closest(".savonie-tab"))&&console.log("[GLOBAL SNIFFER] Click detected on Tab!",{target:e.target,path:e.composedPath(),event:e})},!0);let h=document.createElement("div");h.className="savonie-backdrop";let d=document.createElement("div");d.className="savonie-panel",d.setAttribute("role","dialog"),d.setAttribute("aria-label","Diagnostics HUD"),d.tabIndex=-1;let O=document.createElement("div");O.className="savonie-handle",d.appendChild(O);let A=document.createElement("div");A.className="savonie-header";let _=document.createElement("div");_.className="savonie-title",_.textContent="Diagnostics";let R=document.createElement("div");R.className="savonie-row";let k=document.createElement("button");k.className="savonie-btn secondary",k.type="button",k.textContent="Close",k.dataset.action="close",R.appendChild(k),A.appendChild(_),A.appendChild(R);let x=document.createElement("div");x.className="savonie-tabs";let E=document.createElement("div");E.className="savonie-body",d.appendChild(A),d.appendChild(x),d.appendChild(E);let P=["Summary","Issues","Network","Errors","Performance","Layout","Storage","Accessibility","Security"],u="Summary",L=null,D=null,y=null,w=!1,f=null,C=!1,N=document.body,T=!0,I=!1;function W(e,t){return new Promise((n,o)=>{try{if(t&&window[t])return n(!0);let i=Array.from(document.scripts||[]).find(r=>String(r&&r.src).includes(e));if(i){let r=()=>n(!0),c=()=>o(new Error(`Failed to load ${e}`));i.addEventListener("load",r,{once:!0}),i.addEventListener("error",c,{once:!0}),setTimeout(()=>{t&&window[t]&&n(!0)},0);return}let a=document.createElement("script");a.src=e,a.async=!0,a.crossOrigin="anonymous",a.onload=()=>n(!0),a.onerror=()=>o(new Error(`Failed to load ${e}`)),document.head.appendChild(a)}catch(i){o(i)}})}function K(e){let t={present:!!e,directives:{},issues:[]};if(!e)return t.issues.push("CSP header missing"),t;try{let n=String(e).split(";").map(i=>i.trim()).filter(Boolean);for(let i of n){let a=i.split(/\s+/).filter(Boolean),r=a.shift();r&&(t.directives[r]=a)}let o=String(e);/\bunsafe-inline\b/i.test(o)&&t.issues.push("CSP allows 'unsafe-inline'"),/\bunsafe-eval\b/i.test(o)&&t.issues.push("CSP allows 'unsafe-eval'"),(/\*\s*$/m.test(o)||/\s\*\s/.test(o))&&t.issues.push("CSP contains wildcard (*)")}catch(n){t.issues.push("CSP parse failed")}return t}function j(e){try{let t={critical:6,serious:4,moderate:2,minor:1},n=100;for(let o of e||[]){let i=o&&o.impact?String(o.impact):"minor",a=Array.isArray(o&&o.nodes)?o.nodes.length:1;n-=(t[i]||1)*a}return Math.max(0,Math.min(100,Math.round(n)))}catch(t){return null}}async function X(){let e=Date.now();if(await W("https://unpkg.com/axe-core@4.10.0/axe.min.js","axe"),!window.axe||typeof window.axe.run!="function")throw new Error("axe-core did not initialize (window.axe missing)");let n=await window.axe.run(document,{runOnly:{type:"tag",values:["wcag2aa","wcag2a","best-practice"]},resultTypes:["violations","incomplete"],rules:{"color-contrast":{enabled:!0},label:{enabled:!0},"heading-order":{enabled:!0},"landmark-one-main":{enabled:!0}}}),o=n&&n.violations||[],i=j(o);return{summary:{scannedAt:Date.now(),durationMs:Date.now()-e,score:i,violationCount:o.length,byImpact:o.reduce((r,c)=>{let l=c&&c.impact?String(c.impact):"unknown";return r[l]=(r[l]||0)+1,r},{})},violations:o.map(r=>({id:r.id,impact:r.impact,help:r.help,description:r.description,helpUrl:r.helpUrl,tags:r.tags,nodes:(r.nodes||[]).slice(0,20).map(c=>({target:c.target,html:c.html,failureSummary:c.failureSummary}))}))}}async function Q(){let e=Date.now(),t=await fetch("/",{method:"GET",cache:"no-store"}),n=c=>{try{return t.headers.get(c)}catch(l){return null}},o={"content-security-policy":n("content-security-policy"),"strict-transport-security":n("strict-transport-security"),"x-content-type-options":n("x-content-type-options"),"x-frame-options":n("x-frame-options"),"referrer-policy":n("referrer-policy"),"permissions-policy":n("permissions-policy")},i=K(o["content-security-policy"]),a=Object.entries(o).filter(([,c])=>!c).map(([c])=>c),r=100;return r-=a.length*12,r-=(i.issues||[]).length*10,r=Math.max(0,Math.min(100,Math.round(r))),{scannedAt:Date.now(),durationMs:Date.now()-e,status:t.status,url:t.url,score:r,missing:a,headers:o,csp:i}}let z=0;function B(e){if(e&&e.__hudHandled)return;let t=e&&e.target&&e.target.closest?e.target.closest("button"):null;if(!t||!d.contains(t)||e.type==="click"&&performance.now()-z<650)return;if(e.type==="pointerdown"&&(z=performance.now()),e.__hudHandled=!0,e.preventDefault(),e.stopPropagation(),t.dataset.action==="close"){$();return}if(t.classList.contains("savonie-tab")){let a=t.textContent.trim();console.log(`[HUD] Tab clicked: "${a}"`,{matches:P.includes(a),current:u}),P.includes(a)?(u=a,console.log("[HUD] Setting active tab to:",u),v()):console.warn("[HUD] Tab name not in whitelist:",a);return}let n=t.dataset.action;if(!n)return;let o=m.getState(),i=p?p.get():{consent:null,upload:!1};switch(n){case"export":try{let a=m.export({includeAll:!1});navigator.clipboard.writeText(JSON.stringify(a,null,2)),g("Copied to clipboard")}catch(a){console.error("Export failed:",a)}break;case"toggle-upload":if(p){p.set({upload:!i.upload});let a=p.get();a.consent==="granted"&&m.enable({upload:a.upload,mode:"dev"}),g(a.upload?"Automatic reporting enabled":"Automatic reporting disabled"),v()}break;case"disable":p&&p.revoke(),v();break;case"clear":p&&p.clearData(),v();break;case"copy-issue":try{let a=parseInt(t.dataset.issueIndex,10),r=m.export({includeAll:!1}),c=r&&r.issues?r.issues:[];if(a>=0&&a<c.length){let b={schema:"savonie.issue.v1",issue:c[a],ctx:r?r.ctx:null};navigator.clipboard.writeText(JSON.stringify(b,null,2)),g("Issue copied")}}catch(a){console.error("Copy issue failed:",a)}break;case"run-layout-scan":D=ae(),v();break;case"run-a11y":case"run-a11y-audit":if(w)return;w=!0;try{t.disabled=!0,t.textContent="Running\u2026"}catch(a){}g("Running accessibility audit\u2026"),X().then(a=>{y=a;try{m.push({kind:"a11y",level:"info",msg:"a11y.audit",data:{score:y&&y.summary?y.summary.score:null}})}catch(r){}g("Accessibility audit complete")}).catch(a=>{console.error("A11y audit failed:",a),g("A11y audit failed")}).finally(()=>{w=!1,v()});break;case"clear-a11y":y=null,w=!1,v();break;case"run-security":case"run-security-scan":if(C)return;C=!0;try{t.disabled=!0,t.textContent="Scanning\u2026"}catch(a){}g("Scanning security headers\u2026"),Q().then(a=>{f=a;try{m.push({kind:"security",level:"info",msg:"security.scan",data:{score:f&&f.score}})}catch(r){}g("Security scan complete")}).catch(a=>{console.error("Security scan failed:",a),g("Security scan failed")}).finally(()=>{C=!1,v()});break;case"clear-security":f=null,C=!1,v();break}}d.addEventListener("pointerdown",B,{capture:!0}),d.addEventListener("click",B,{capture:!0}),h.addEventListener("click",e=>{e.target===h&&$()});function g(e){let t=document.createElement("div");t.style.cssText=`
      position: fixed;
      left: 50%;
      bottom: 20px;
      transform: translateX(-50%);
      background: rgba(33,40,66,0.95);
      color: white;
      padding: 10px 16px;
      border-radius: 8px;
      z-index: 999999;
      font-size: 13px;
      pointer-events: none;
    `,t.textContent=e,document.body.appendChild(t),setTimeout(()=>t.remove(),2e3)}function s(e,t={}){let n=document.createElement(e);e==="button"&&!("type"in t)&&(n.type="button");for(let[o,i]of Object.entries(t))o==="text"?n.textContent=i:o==="class"?n.className=i:(o.startsWith("data-"),n.setAttribute(o,i));return n}function V(){x.innerHTML="",x.style.pointerEvents="auto",x.style.position="relative",x.style.zIndex="2147483647";for(let e of P){let t=s("button",{class:"savonie-tab",type:"button",role:"tab","aria-selected":e===u?"true":"false",text:e});t.style.pointerEvents="auto",t.style.cursor="pointer",t.addEventListener("click",function(o){o.preventDefault(),o.stopPropagation(),u!==e&&(u=e,v())},{capture:!0}),x.appendChild(t)}}function Y(e){let t=p?p.get():{consent:null,upload:!1,storage:"unknown"},n=s("div",{class:"savonie-list"}),o=s("div",{class:"savonie-card"}),i=s("div",{class:"savonie-kv"}),a=[["URL",location.href],["Referrer",document.referrer||""],["Build",e.buildVersion],["Viewport",`${window.innerWidth}x${window.innerHeight} @${window.devicePixelRatio}`],["Consent",String(t.consent||"unset")],["Automatic reporting",t.upload?"on":"off"],["Storage",t.storage],["Enabled",e.enabled?"true":"false"],["Last upload",e.lastUploadAt?new Date(e.lastUploadAt).toLocaleString():"never"],["Issues",String((e.issues||[]).length)]];for(let[l,b]of a)i.appendChild(s("div",{class:"savonie-k",text:l})),i.appendChild(s("div",{class:"savonie-v",text:String(b)}));o.appendChild(i);let r=s("div",{class:"savonie-card"}),c=s("div",{class:"savonie-row"});return c.appendChild(s("button",{class:"savonie-btn",type:"button","data-action":"export",text:"Copy export JSON"})),c.appendChild(s("button",{class:"savonie-btn secondary",type:"button","data-action":"toggle-upload",text:t.upload?"Disable automatic reporting":"Enable automatic reporting"})),c.appendChild(s("button",{class:"savonie-btn secondary",type:"button","data-action":"disable",text:"Disable diagnostics"})),c.appendChild(s("button",{class:"savonie-btn secondary",type:"button","data-action":"clear",text:"Delete diagnostics data"})),r.appendChild(c),n.appendChild(o),n.appendChild(r),n}function Z(e){let t=s("div",{class:"savonie-list"}),n=(e.issues||[]).slice().reverse();return n.length?(n.forEach((o,i)=>{let a=s("div",{class:"savonie-card"}),r=s("div",{class:"savonie-row"});r.appendChild(s("div",{class:"savonie-pill",text:o.kind})),r.appendChild(s("div",{class:"savonie-pill",text:`count ${o.count}`})),r.appendChild(s("div",{class:"savonie-pill",text:new Date(o.lastSeen).toLocaleTimeString()}));let c=s("div",{class:"savonie-mono"});c.textContent=`${o.msg}
${o.url}
${o.signature}`;let l=s("div",{class:"savonie-row"});if(l.appendChild(s("button",{class:"savonie-btn",type:"button","data-action":"copy-issue","data-issue-index":String(i),text:"Copy issue report"})),a.appendChild(r),a.appendChild(c),o.stack){let b=s("div",{class:"savonie-mono"});b.textContent=o.stack,a.appendChild(b)}a.appendChild(l),t.appendChild(a)}),t):(t.appendChild(s("div",{class:"savonie-card",text:"No issues recorded."})),t)}function G(e){let t=s("div",{class:"savonie-list"}),n=(e.events||[]).filter(o=>o.kind==="network").slice(-80).reverse();if(!n.length)return t.appendChild(s("div",{class:"savonie-card",text:"No network events captured."})),t;for(let o of n){let i=s("div",{class:"savonie-card"}),a=o.data||{};i.appendChild(s("div",{class:"savonie-mono",text:`${a.method||""} ${a.url||""}
status ${a.status}  dur ${a.dur}ms`})),t.appendChild(i)}return t}function ee(e){let t=s("div",{class:"savonie-list"}),n=(e.events||[]).filter(o=>o.kind==="error"||o.kind==="resource").slice(-80).reverse();if(!n.length)return t.appendChild(s("div",{class:"savonie-card",text:"No errors captured."})),t;for(let o of n){let i=s("div",{class:"savonie-card"}),a=o.data||{},r=s("div",{class:"savonie-mono"});r.textContent=`${o.msg}
${a.message||""}
${a.filename||""}:${a.line||""}:${a.col||""}
${a.url||""}
${a.stack||""}`,i.appendChild(r),t.appendChild(i)}return t}function te(e){let t=s("div",{class:"savonie-list"}),n=e.perf||{},o=s("div",{class:"savonie-card"}),i=s("div",{class:"savonie-kv"}),a=n.lcpAttribution&&n.lcpAttribution.selector?String(n.lcpAttribution.selector):"n/a",r=n.lcpAttribution&&n.lcpAttribution.url?String(n.lcpAttribution.url):"n/a",c=n.clsAttribution&&n.clsAttribution.selector?String(n.clsAttribution.selector):"n/a",l=n.inpAttribution&&n.inpAttribution.selector?String(n.inpAttribution.selector):"n/a",b=[["CLS",n.cls==null?"n/a":String(n.cls)],["LCP",n.lcp==null?"n/a":`${Math.round(n.lcp)}ms`],["INP",n.inp==null?"n/a":`${Math.round(n.inp)}ms`],["Long tasks",String(n.longTasks||0)],["Long task max",n.longTaskMax==null?"n/a":`${Math.round(n.longTaskMax)}ms`],["LCP element",a],["LCP resource",r],["CLS source",c],["INP target",l]];for(let[S,H]of b)i.appendChild(s("div",{class:"savonie-k",text:S})),i.appendChild(s("div",{class:"savonie-v",text:H}));return o.appendChild(i),t.appendChild(o),t}function ne(){let e=s("div",{class:"savonie-list"}),t=s("div",{class:"savonie-card"});t.appendChild(s("div",{text:"On-demand scan only. No continuous DOM scanning."}));let n=s("div",{class:"savonie-row"});if(n.appendChild(s("button",{class:"savonie-btn",type:"button","data-action":"run-layout-scan",text:"Run scan"})),t.appendChild(n),e.appendChild(t),D){let o=s("div",{class:"savonie-card"}),i=s("div",{class:"savonie-mono"});i.textContent=JSON.stringify(D,null,2),o.appendChild(i),e.appendChild(o)}return e}function ae(){let e={scannedAt:Date.now(),tinyTargets:[],overflows:[]},t=document.querySelectorAll("a,button,[role='button'],input,select,textarea");for(let o of t){let i=o.getBoundingClientRect();if(i.width>0&&i.height>0&&(i.width<44||i.height<44)&&(e.tinyTargets.push({tag:o.tagName,w:Math.round(i.width),h:Math.round(i.height)}),e.tinyTargets.length>=20))break}let n=document.querySelectorAll("body *");for(let o=0;o<Math.min(n.length,1500);o++){let i=n[o],a=i.getBoundingClientRect();if(a.right>window.innerWidth+1&&(e.overflows.push({tag:i.tagName,right:Math.round(a.right),vw:window.innerWidth}),e.overflows.length>=20))break}return e}function de(e){D=e,v()}function oe(){let e=s("div",{class:"savonie-list"}),t=s("div",{class:"savonie-card"}),n=s("div",{class:"savonie-kv"}),o="n/a",i="n/a";try{o=String(localStorage.length)}catch(c){}try{i=String(sessionStorage.length)}catch(c){}let a=navigator.serviceWorker,r={controller:!!(a&&a.controller),scope:"n/a"};return n.appendChild(s("div",{class:"savonie-k",text:"localStorage keys"})),n.appendChild(s("div",{class:"savonie-v",text:o})),n.appendChild(s("div",{class:"savonie-k",text:"sessionStorage keys"})),n.appendChild(s("div",{class:"savonie-v",text:i})),n.appendChild(s("div",{class:"savonie-k",text:"SW controller"})),n.appendChild(s("div",{class:"savonie-v",text:r.controller?"true":"false"})),t.appendChild(n),e.appendChild(t),e}function se(){let e=s("div",{class:"savonie-list"}),t=s("div",{class:"savonie-card"});t.appendChild(s("div",{text:"On-demand only. Loads axe-core from unpkg when you click Run."}));let n=s("div",{class:"savonie-row"}),o=s("button",{class:"savonie-btn",type:"button","data-action":"run-a11y",text:w?"Running...":"Run audit"});if(w&&(o.disabled=!0),n.appendChild(o),n.appendChild(s("button",{class:"savonie-btn secondary",type:"button","data-action":"clear-a11y",text:"Clear"})),t.appendChild(n),e.appendChild(t),!y)return e.appendChild(s("div",{class:"savonie-card",text:"No accessibility results yet."})),e;let i=s("div",{class:"savonie-card"}),a=y.summary||{},r=s("div",{class:"savonie-kv"}),c=[["Score",a.score==null?"n/a":`${a.score}/100`],["Violations",String(a.violationCount||0)],["Duration",`${Math.round(a.durationMs||0)}ms`]];for(let[S,H]of c)r.appendChild(s("div",{class:"savonie-k",text:S})),r.appendChild(s("div",{class:"savonie-v",text:H}));i.appendChild(r),e.appendChild(i);let l=s("div",{class:"savonie-card"}),b=s("div",{class:"savonie-mono"});return b.textContent=JSON.stringify(y,null,2),l.appendChild(b),e.appendChild(l),e}function ie(){let e=s("div",{class:"savonie-list"}),t=s("div",{class:"savonie-card"});t.appendChild(s("div",{text:"On-demand only. Fetches / and inspects response headers."}));let n=s("div",{class:"savonie-row"}),o=s("button",{class:"savonie-btn",type:"button","data-action":"run-security",text:C?"Scanning...":"Run scan"});if(C&&(o.disabled=!0),n.appendChild(o),n.appendChild(s("button",{class:"savonie-btn secondary",type:"button","data-action":"clear-security",text:"Clear"})),t.appendChild(n),e.appendChild(t),!f)return e.appendChild(s("div",{class:"savonie-card",text:"No security scan results yet."})),e;let i=s("div",{class:"savonie-card"}),a=s("div",{class:"savonie-kv"}),r=[["Score",f.score==null?"n/a":`${f.score}/100`],["Status",String(f.status)],["Missing headers",String((f.missing||[]).length)],["CSP issues",String(f.csp&&f.csp.issues?f.csp.issues.length:0)]];for(let[b,S]of r)a.appendChild(s("div",{class:"savonie-k",text:b})),a.appendChild(s("div",{class:"savonie-v",text:S}));i.appendChild(a),e.appendChild(i);let c=s("div",{class:"savonie-card"}),l=s("div",{class:"savonie-mono"});return l.textContent=JSON.stringify(f,null,2),c.appendChild(l),e.appendChild(c),e}function v(){let e=m.getState();V(),E.innerHTML="";let t=null;u==="Summary"&&(t=Y(e)),u==="Issues"&&(t=Z(e)),u==="Network"&&(t=G(e)),u==="Errors"&&(t=ee(e)),u==="Performance"&&(t=te(e)),u==="Layout"&&(t=ne()),u==="Storage"&&(t=oe()),u==="Accessibility"&&(t=se()),u==="Security"&&(t=ie()),E.appendChild(t||s("div",{class:"savonie-card",text:"Not implemented."}))}function F(e){if(e.key!=="Tab")return;let t=d.querySelectorAll("button,[href],input,select,textarea,[tabindex]:not([tabindex='-1'])");if(!t.length)return;let n=t[0],o=t[t.length-1];e.shiftKey&&document.activeElement===n?(e.preventDefault(),o.focus()):!e.shiftKey&&document.activeElement===o&&(e.preventDefault(),n.focus())}function q(e={}){let t=e||{};if(I=!!t.embedded,T=I?!1:t.backdrop!==!1,N=t.mount||document.body,d.style.pointerEvents="auto",d.style.zIndex="2147483647",I?d.classList.add("savonie-embedded"):d.classList.remove("savonie-embedded"),d.isConnected){d.parentElement!==N&&N.appendChild(d),T&&!h.isConnected&&document.body.appendChild(h),!T&&h.isConnected&&h.remove(),v(),d.focus();return}L=document.activeElement,T&&document.body.appendChild(h),N.appendChild(d),document.body.classList.add("savonie-open"),v(),d.focus(),document.addEventListener("keydown",J,!0),document.addEventListener("keydown",F,!0)}function $(){if(document.removeEventListener("keydown",J,!0),document.removeEventListener("keydown",F,!0),document.body.classList.remove("savonie-open"),h.isConnected&&h.remove(),d.isConnected&&d.remove(),L&&L.focus)try{L.focus()}catch(e){}}function J(e){e.key==="Escape"&&$()}let U=0;m.subscribe(()=>{d.isConnected&&(U||(U=requestAnimationFrame(()=>{U=0,v()})))}),window.__SavonieHUD={open:q,close:$},window.__SavonieHUD_AUTOOPEN===!0&&q()})()});ce();})();
