(function(){"use strict";const s=[],c=window.__collectedLogs||[];let b=!1,u="summary",D=!0;function N(e,a){const t={timestamp:Date.now(),type:e,data:a};s.push(t),s.length>1e3&&s.shift(),r()}function x(){const e=document.createElement("div");e.id="debugger-hud",e.innerHTML=`
      <style>
        #debugger-hud {
          --dbg-bg: rgba(33, 40, 66, 0.98);
          --dbg-text: #e1d4c2;
          --dbg-border: rgba(225, 212, 194, 0.1);
          --dbg-accent: #4a90e2;
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
          font-size: 13px;
          color: var(--dbg-text);
          position: fixed;
          z-index: 999999;
          isolation: isolate;
        }
        
        #debugger-hud.collapsed {
          bottom: 20px;
          right: 20px;
          bottom: calc(20px + env(safe-area-inset-bottom, 0px));
          right: calc(20px + env(safe-area-inset-right, 0px));
        }
        
        #debugger-hud.expanded {
          bottom: 0;
          right: 0;
          top: auto;
          left: 0;
          display: flex;
          flex-direction: column;
        }
        
        @media (min-width: 768px) {
          #debugger-hud.expanded {
            left: auto;
            width: 400px;
            top: 0;
            bottom: 0;
          }
        }
        
        .dbg-pill {
          background: var(--dbg-bg);
          backdrop-filter: blur(10px);
          border: 1px solid var(--dbg-border);
          border-radius: 24px;
          padding: 12px 20px;
          cursor: pointer;
          user-select: none;
          box-shadow: 0 4px 20px rgba(0,0,0,0.3);
          display: flex;
          align-items: center;
          gap: 8px;
          min-width: 44px;
          min-height: 44px;
          touch-action: manipulation;
        }
        
        .dbg-pill:active {
          transform: scale(0.98);
        }
        
        .dbg-panel {
          background: var(--dbg-bg);
          backdrop-filter: blur(10px);
          border: 1px solid var(--dbg-border);
          border-radius: 16px 16px 0 0;
          display: flex;
          flex-direction: column;
          height: 60vh;
          max-height: calc(100vh - 60px);
          padding-bottom: env(safe-area-inset-bottom, 0px);
          box-shadow: 0 -4px 30px rgba(0,0,0,0.4);
        }
        
        @media (min-width: 768px) {
          .dbg-panel {
            border-radius: 0;
            height: 100%;
            max-height: 100vh;
          }
        }
        
        .dbg-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 16px;
          border-bottom: 1px solid var(--dbg-border);
          cursor: move;
          user-select: none;
        }
        
        .dbg-title {
          font-weight: 600;
          font-size: 14px;
        }
        
        .dbg-close {
          background: none;
          border: none;
          color: var(--dbg-text);
          font-size: 24px;
          line-height: 1;
          cursor: pointer;
          padding: 0;
          min-width: 44px;
          min-height: 44px;
          display: flex;
          align-items: center;
          justify-content: center;
        }
        
        .dbg-tabs {
          display: flex;
          gap: 4px;
          padding: 8px;
          border-bottom: 1px solid var(--dbg-border);
          overflow-x: auto;
          scrollbar-width: thin;
        }
        
        .dbg-tab {
          background: transparent;
          border: none;
          color: var(--dbg-text);
          opacity: 0.6;
          padding: 8px 12px;
          border-radius: 6px;
          cursor: pointer;
          white-space: nowrap;
          font-size: 12px;
          min-width: 44px;
          min-height: 44px;
          display: flex;
          align-items: center;
          justify-content: center;
        }
        
        .dbg-tab.active {
          opacity: 1;
          background: rgba(74, 144, 226, 0.2);
          color: var(--dbg-accent);
        }
        
        .dbg-content {
          flex: 1;
          overflow-y: auto;
          padding: 12px;
        }
        
        .dbg-actions {
          display: flex;
          gap: 8px;
          padding: 12px;
          border-top: 1px solid var(--dbg-border);
          flex-wrap: wrap;
        }
        
        .dbg-btn {
          background: var(--dbg-accent);
          color: white;
          border: none;
          border-radius: 6px;
          padding: 8px 16px;
          cursor: pointer;
          font-size: 12px;
          min-width: 44px;
          min-height: 44px;
        }
        
        .dbg-btn:active {
          transform: scale(0.98);
        }
        
        .dbg-log-entry {
          padding: 8px;
          border-bottom: 1px solid var(--dbg-border);
          font-family: 'Courier New', monospace;
          font-size: 11px;
        }
        
        .dbg-log-entry.error {
          background: rgba(244, 67, 54, 0.1);
        }
        
        .dbg-log-entry.warn {
          background: rgba(255, 152, 0, 0.1);
        }
        
        .dbg-table {
          width: 100%;
          border-collapse: collapse;
          font-size: 11px;
        }
        
        .dbg-table th {
          background: rgba(255,255,255,0.05);
          padding: 8px 4px;
          text-align: left;
          border-bottom: 1px solid var(--dbg-border);
        }
        
        .dbg-table td {
          padding: 6px 4px;
          border-bottom: 1px solid rgba(225,212,194,0.05);
        }
        
        .dbg-stat {
          display: flex;
          justify-content: space-between;
          padding: 8px 0;
          border-bottom: 1px solid rgba(225,212,194,0.05);
        }
        
        .dbg-stat-label {
          opacity: 0.7;
        }
        
        .dbg-stat-value {
          font-weight: 600;
        }
      </style>
      
      <div class="dbg-pill">
        <span>\u{1F41B}</span>
        <span>DBG</span>
      </div>
      
      <div class="dbg-panel" style="display:none;">
        <div class="dbg-header">
          <div class="dbg-title">Debugger</div>
          <button class="dbg-close" aria-label="Close debugger">&times;</button>
        </div>
        
        <div class="dbg-tabs">
          <button class="dbg-tab active" data-tab="summary">Summary</button>
          <button class="dbg-tab" data-tab="console">Console</button>
          <button class="dbg-tab" data-tab="network">Network</button>
          <button class="dbg-tab" data-tab="performance">Performance</button>
          <button class="dbg-tab" data-tab="layout">Layout</button>
          <button class="dbg-tab" data-tab="storage">Storage/PWA</button>
        </div>
        
        <div class="dbg-content"></div>
        
        <div class="dbg-actions">
          <button class="dbg-btn" id="dbg-export">Export JSON</button>
          <button class="dbg-btn" id="dbg-copy">Copy</button>
          <button class="dbg-btn" id="dbg-clear">Clear</button>
        </div>
      </div>
    `,document.body.appendChild(e),f(),r()}function f(){const e=document.querySelector(".dbg-pill"),a=document.querySelector(".dbg-panel"),t=document.querySelector(".dbg-close"),n=document.querySelectorAll(".dbg-tab");e.addEventListener("click",o),t.addEventListener("click",o),n.forEach(d=>{d.addEventListener("click",()=>{u=d.dataset.tab,n.forEach(p=>p.classList.remove("active")),d.classList.add("active"),r()})}),document.getElementById("dbg-export").addEventListener("click",E),document.getElementById("dbg-copy").addEventListener("click",S),document.getElementById("dbg-clear").addEventListener("click",T)}function o(){b=!b;const e=document.getElementById("debugger-hud"),a=document.querySelector(".dbg-pill"),t=document.querySelector(".dbg-panel");b?(e.classList.add("expanded"),e.classList.remove("collapsed"),a.style.display="none",t.style.display="flex"):(e.classList.remove("expanded"),e.classList.add("collapsed"),a.style.display="flex",t.style.display="none"),r()}function r(){const e=document.querySelector(".dbg-content");if(!e)return;const a=[...c,...s];switch(u){case"summary":e.innerHTML=h(a);break;case"console":e.innerHTML=v(a);break;case"network":e.innerHTML=y(a);break;case"performance":e.innerHTML=w(a);break;case"layout":e.innerHTML=L();break;case"storage":e.innerHTML=k(a);break}}function h(e){const a=e.filter(n=>n.msg&&n.msg.includes("error")).length,t=e.filter(n=>n.msg&&n.msg.includes("fetch.error")).length;return`
      <div class="dbg-stat"><span class="dbg-stat-label">URL</span><span class="dbg-stat-value">${location.href}</span></div>
      <div class="dbg-stat"><span class="dbg-stat-label">Viewport</span><span class="dbg-stat-value">${window.innerWidth}x${window.innerHeight}</span></div>
      <div class="dbg-stat"><span class="dbg-stat-label">DPR</span><span class="dbg-stat-value">${window.devicePixelRatio}</span></div>
      <div class="dbg-stat"><span class="dbg-stat-label">User Agent</span><span class="dbg-stat-value">${navigator.userAgent.slice(0,80)}...</span></div>
      <div class="dbg-stat"><span class="dbg-stat-label">Errors</span><span class="dbg-stat-value">${a}</span></div>
      <div class="dbg-stat"><span class="dbg-stat-label">Network Errors</span><span class="dbg-stat-value">${t}</span></div>
      <div class="dbg-stat"><span class="dbg-stat-label">Events Logged</span><span class="dbg-stat-value">${e.length}</span></div>
    `}function v(e){const a=e.filter(t=>t.msg&&t.msg.startsWith("console."));return a.length?a.map(t=>{const n=t.msg.split(".")[1]||"log",d=t.data&&t.data.args?t.data.args.join(" "):"";return`<div class="dbg-log-entry ${n}">[${new Date(t.t).toLocaleTimeString()}] ${d}</div>`}).join(""):"<p>No console logs</p>"}function y(e){const a=e.filter(t=>t.msg&&(t.msg.includes("fetch")||t.msg.includes("xhr")));return a.length?`<table class="dbg-table">
      <thead><tr><th>Time</th><th>Method</th><th>URL</th><th>Status</th></tr></thead>
      <tbody>${a.map(t=>{const n=t.data&&t.data.url?t.data.url:"",d=t.data&&t.data.method?t.data.method:"GET",p=t.data&&t.data.status?t.data.status:"-";return`<tr><td>${new Date(t.t).toLocaleTimeString()}</td><td>${d}</td><td>${n.slice(0,50)}</td><td>${p}</td></tr>`}).join("")}</tbody>
    </table>`:"<p>No network activity</p>"}function w(e){const a=e.filter(t=>t.msg&&t.msg.startsWith("perf."));return`<p>Performance entries: ${a.length}</p>`+a.slice(0,20).map(t=>`<div class="dbg-log-entry">${t.msg}: ${JSON.stringify(t.data)}</div>`).join("")}function L(){return"<p>Layout scanner coming soon...</p>"}function k(e){return e.filter(t=>t.msg&&(t.msg.includes("Storage")||t.msg.includes("sw."))).map(t=>`<div class="dbg-log-entry">${t.msg}: ${JSON.stringify(t.data)}</div>`).join("")||"<p>No storage activity</p>"}function E(){const e={version:"1.0.0",timestamp:Date.now(),url:location.href,logs:[...c,...s]},a=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),t=URL.createObjectURL(a),n=document.createElement("a");n.href=t,n.download=`debugger-${Date.now()}.json`,n.click(),URL.revokeObjectURL(t)}function S(){const e=JSON.stringify([...c,...s],null,2);navigator.clipboard.writeText(e).then(()=>{alert("Copied to clipboard")}).catch(()=>{alert("Copy failed")})}function T(){s.length=0,r()}let i=[],l=0,g=null;document.addEventListener("touchstart",e=>{if(e.touches.length===3){const a=Date.now();i.push(a),setTimeout(()=>{i.length>=3&&Date.now()-i[0]>=600&&(o(),i=[])},600)}}),document.addEventListener("touchend",()=>{i=[]});const m=document.querySelector('a[href="/"]');m&&m.addEventListener("click",e=>{l++,g&&clearTimeout(g),g=setTimeout(()=>{l=0},500),l===3&&(e.preventDefault(),o(),l=0)}),document.addEventListener("keydown",e=>{(e.ctrlKey||e.metaKey)&&e.shiftKey&&e.key==="D"&&(e.preventDefault(),o())}),x(),document.getElementById("debugger-hud").classList.add("collapsed")})();
