export const ACHIEVEMENTS = {
    // Snake Achievements
    snake_first_food: {
        id: 'snake_first_food',
        game: 'snake',
        title: 'First Bite',
        description: 'Eat your first food',
        difficulty: 'Easy',
        icon: 'ðŸŽ'
    },
    snake_combo_5: {
        id: 'snake_combo_5',
        game: 'snake',
        title: 'Combo Master',
        description: 'Reach 5x multiplier',
        difficulty: 'Medium',
        icon: 'âš¡'
    },
    snake_score_100: {
        id: 'snake_score_100',
        game: 'snake',
        title: 'Century',
        description: 'Score 100 points',
        difficulty: 'Easy',
        icon: 'ðŸ’¯'
    },
    snake_length_20: {
        id: 'snake_length_20',
        game: 'snake',
        title: 'Long Snake',
        description: 'Grow to length 20',
        difficulty: 'Medium',
        icon: 'ðŸ'
    },
    snake_level_5: {
        id: 'snake_level_5',
        game: 'snake',
        title: 'Speed Demon',
        description: 'Reach Level 5',
        difficulty: 'Medium',
        icon: 'ðŸš€'
    },
    snake_score_250: {
        id: 'snake_score_250',
        game: 'snake',
        title: 'Quarter-Mil',
        description: 'Score 250 points',
        difficulty: 'Hard',
        icon: 'ðŸ'
    },
    snake_length_35: {
        id: 'snake_length_35',
        game: 'snake',
        title: 'Anaconda',
        description: 'Grow to length 35',
        difficulty: 'Hard',
        icon: 'ðŸ'
    },
    snake_level_10: {
        id: 'snake_level_10',
        game: 'snake',
        title: 'Supersonic',
        description: 'Reach Level 10',
        difficulty: 'Hard',
        icon: 'ðŸ’¨'
    },

    // Block Breaker Achievements
    breaker_first_brick: {
        id: 'breaker_first_brick',
        game: 'breaker',
        title: 'First Break',
        description: 'Destroy your first brick',
        difficulty: 'Easy',
        icon: 'ðŸ§±'
    },
    breaker_score_500: {
        id: 'breaker_score_500',
        game: 'breaker',
        title: 'High Scorer',
        description: 'Score 500 points',
        difficulty: 'Easy',
        icon: 'ðŸ†'
    },
    breaker_perfect_level: {
        id: 'breaker_perfect_level',
        game: 'breaker',
        title: 'Perfectionist',
        description: 'Clear a level perfectly',
        difficulty: 'Medium',
        icon: 'â­'
    },
    breaker_level_3: {
        id: 'breaker_level_3',
        game: 'breaker',
        title: 'Veteran',
        description: 'Reach Level 3',
        difficulty: 'Easy',
        icon: 'ðŸŽ–ï¸'
    },
    breaker_powerup_5: {
        id: 'breaker_powerup_5',
        game: 'breaker',
        title: 'Power Player',
        description: 'Collect 5 powerups',
        difficulty: 'Easy',
        icon: 'âš¡'
    },
    breaker_score_1000: {
        id: 'breaker_score_1000',
        game: 'breaker',
        title: 'Four Digits',
        description: 'Score 1000 points',
        difficulty: 'Medium',
        icon: 'ðŸ”¢'
    },
    breaker_level_5: {
        id: 'breaker_level_5',
        game: 'breaker',
        title: 'Brick Wall',
        description: 'Reach Level 5',
        difficulty: 'Medium',
        icon: 'ðŸ§±'
    },
    breaker_powerup_10: {
        id: 'breaker_powerup_10',
        game: 'breaker',
        title: 'Power Hoarder',
        description: 'Collect 10 powerups',
        difficulty: 'Hard',
        icon: 'âš¡'
    },

    // 2048 Achievements
    merge_tile_128: {
        id: 'merge_tile_128',
        game: 'merge',
        title: 'Getting Warm',
        description: 'Create a 128 tile',
        difficulty: 'Easy',
        icon: 'ðŸŒ¡ï¸'
    },
    merge_tile_512: {
        id: 'merge_tile_512',
        game: 'merge',
        title: 'Halfway There',
        description: 'Create a 512 tile',
        difficulty: 'Medium',
        icon: 'ðŸŒ“'
    },
    merge_tile_1024: {
        id: 'merge_tile_1024',
        game: 'merge',
        title: 'So Close',
        description: 'Create a 1024 tile',
        difficulty: 'Hard',
        icon: 'ðŸ˜±'
    },
    merge_tile_2048: {
        id: 'merge_tile_2048',
        game: 'merge',
        title: '2048 Master',
        description: 'Create the 2048 tile!',
        difficulty: 'Hard',
        icon: 'ðŸ‘‘'
    },
    merge_score_5000: {
        id: 'merge_score_5000',
        game: 'merge',
        title: 'Merge Master',
        description: 'Score 5000 points',
        difficulty: 'Medium',
        icon: 'ðŸ§ '
    },
    merge_tile_4096: {
        id: 'merge_tile_4096',
        game: 'merge',
        title: 'Beyond 2048',
        description: 'Create a 4096 tile',
        difficulty: 'Hard',
        icon: 'ðŸ”¥'
    },
    merge_score_10000: {
        id: 'merge_score_10000',
        game: 'merge',
        title: 'Ten Thousand',
        description: 'Score 10000 points',
        difficulty: 'Hard',
        icon: 'ðŸ…'
    },

    // Space Invaders Achievements
    invaders_first_kill: {
        id: 'invaders_first_kill',
        game: 'invaders',
        title: 'First Blood',
        description: 'Destroy an alien',
        difficulty: 'Easy',
        icon: 'ðŸ‘¾'
    },
    invaders_wave_3: {
        id: 'invaders_wave_3',
        game: 'invaders',
        title: 'Survivor',
        description: 'Complete 3 waves',
        difficulty: 'Medium',
        icon: 'ðŸŒŠ'
    },
    invaders_aliens_50: {
        id: 'invaders_aliens_50',
        game: 'invaders',
        title: 'Exterminator',
        description: 'Destroy 50 aliens',
        difficulty: 'Medium',
        icon: 'ðŸ”«'
    },
    invaders_score_500: {
        id: 'invaders_score_500',
        game: 'invaders',
        title: 'Defender',
        description: 'Score 500 points',
        difficulty: 'Easy',
        icon: 'ðŸ›¡ï¸'
    },
    invaders_perfect_wave: {
        id: 'invaders_perfect_wave',
        game: 'invaders',
        title: 'Sharpshooter',
        description: 'Complete a wave perfectly',
        difficulty: 'Hard',
        icon: 'ðŸŽ¯'
    },
    invaders_wave_5: {
        id: 'invaders_wave_5',
        game: 'invaders',
        title: 'Wave Rider',
        description: 'Complete 5 waves',
        difficulty: 'Hard',
        icon: 'ðŸŒŠ'
    },
    invaders_aliens_200: {
        id: 'invaders_aliens_200',
        game: 'invaders',
        title: 'Alien Hunter',
        description: 'Destroy 200 aliens',
        difficulty: 'Hard',
        icon: 'ðŸ’¥'
    },
    invaders_score_2000: {
        id: 'invaders_score_2000',
        game: 'invaders',
        title: 'Space Ace',
        description: 'Score 2000 points',
        difficulty: 'Hard',
        icon: 'ðŸš€'
    },

    // Site Achievements (mirrors ids used by assets/js/site.js)
    explorer: {
        id: 'explorer',
        game: 'site',
        title: 'Explorer',
        description: 'Visit all main pages',
        difficulty: 'Easy',
        icon: 'ðŸ—ºï¸'
    },
    reader: {
        id: 'reader',
        game: 'site',
        title: 'Reader',
        description: 'Visit the Deep Dive page',
        difficulty: 'Easy',
        icon: 'ðŸ“–'
    },
    nightOwl: {
        id: 'nightOwl',
        game: 'site',
        title: 'Night Owl',
        description: 'Toggle dark mode',
        difficulty: 'Easy',
        icon: 'ðŸŒ™'
    },
    networker: {
        id: 'networker',
        game: 'site',
        title: 'Networker',
        description: 'Click a social link (LinkedIn/GitHub)',
        difficulty: 'Easy',
        icon: 'ðŸ”—'
    },
    konami: {
        id: 'konami',
        game: 'site',
        title: 'Konami',
        description: 'Trigger the Konami code easter egg',
        difficulty: 'Medium',
        icon: 'ðŸŽ¯'
    },
    gamer: {
        id: 'gamer',
        game: 'site',
        title: 'Gamer',
        description: 'Play a game on the site',
        difficulty: 'Easy',
        icon: 'ðŸŽ®'
    },
    chatter: {
        id: 'chatter',
        game: 'site',
        title: 'Chatter',
        description: 'Open the chat widget',
        difficulty: 'Easy',
        icon: 'ðŸ’¬'
    },
    formFiller: {
        id: 'formFiller',
        game: 'site',
        title: 'Form Filler',
        description: 'Submit the contact form',
        difficulty: 'Easy',
        icon: 'âœ‰ï¸'
    },

    // Third-party mini-game wrapper achievements (lightweight + consistent)
    mini_1024_moves_visit: {
        id: 'mini_1024_moves_visit',
        game: 'mini_1024_moves',
        title: 'Booted Up',
        description: 'Open 1024 Moves',
        difficulty: 'Easy',
        icon: 'ðŸ§Š'
    },
    mini_1024_moves_stay_60: {
        id: 'mini_1024_moves_stay_60',
        game: 'mini_1024_moves',
        title: 'Still Thinking',
        description: 'Stay on 1024 Moves for 60 seconds',
        difficulty: 'Easy',
        icon: 'â³'
    },
    mini_1024_moves_stay_180: {
        id: 'mini_1024_moves_stay_180',
        game: 'mini_1024_moves',
        title: 'Locked In',
        description: 'Stay on 1024 Moves for 3 minutes',
        difficulty: 'Medium',
        icon: 'â±ï¸'
    },
    mini_1024_moves_stay_300: {
        id: 'mini_1024_moves_stay_300',
        game: 'mini_1024_moves',
        title: 'Zen Mode',
        description: 'Stay on 1024 Moves for 5 minutes',
        difficulty: 'Hard',
        icon: 'ðŸ§˜'
    },
    mini_oh_flip_visit: {
        id: 'mini_oh_flip_visit',
        game: 'mini_oh_flip',
        title: 'Flip Start',
        description: 'Open Oh Flip',
        difficulty: 'Easy',
        icon: 'ðŸ”„'
    },
    mini_oh_flip_stay_60: {
        id: 'mini_oh_flip_stay_60',
        game: 'mini_oh_flip',
        title: 'Keep Flipping',
        description: 'Stay on Oh Flip for 60 seconds',
        difficulty: 'Easy',
        icon: 'â³'
    },
    mini_oh_flip_stay_180: {
        id: 'mini_oh_flip_stay_180',
        game: 'mini_oh_flip',
        title: 'Rhythm',
        description: 'Stay on Oh Flip for 3 minutes',
        difficulty: 'Medium',
        icon: 'â±ï¸'
    },
    mini_oh_flip_stay_300: {
        id: 'mini_oh_flip_stay_300',
        game: 'mini_oh_flip',
        title: 'Unshaken',
        description: 'Stay on Oh Flip for 5 minutes',
        difficulty: 'Hard',
        icon: 'ðŸ§˜'
    },
    mini_onoff_visit: {
        id: 'mini_onoff_visit',
        game: 'mini_onoff',
        title: 'Power On',
        description: 'Open On/Off',
        difficulty: 'Easy',
        icon: 'ðŸ’¡'
    },
    mini_onoff_stay_60: {
        id: 'mini_onoff_stay_60',
        game: 'mini_onoff',
        title: 'Logic Loop',
        description: 'Stay on On/Off for 60 seconds',
        difficulty: 'Easy',
        icon: 'â³'
    },
    mini_onoff_stay_180: {
        id: 'mini_onoff_stay_180',
        game: 'mini_onoff',
        title: 'Circuit Brain',
        description: 'Stay on On/Off for 3 minutes',
        difficulty: 'Medium',
        icon: 'â±ï¸'
    },
    mini_onoff_stay_300: {
        id: 'mini_onoff_stay_300',
        game: 'mini_onoff',
        title: 'Master Switch',
        description: 'Stay on On/Off for 5 minutes',
        difficulty: 'Hard',
        icon: 'ðŸ§ '
    },
    mini_triangle_home_visit: {
        id: 'mini_triangle_home_visit',
        game: 'mini_triangle_home',
        title: 'Point A to Home',
        description: 'Open Triangle Home',
        difficulty: 'Easy',
        icon: 'ðŸ”º'
    },
    mini_triangle_home_stay_60: {
        id: 'mini_triangle_home_stay_60',
        game: 'mini_triangle_home',
        title: 'Geometric Patience',
        description: 'Stay on Triangle Home for 60 seconds',
        difficulty: 'Easy',
        icon: 'â³'
    },
    mini_triangle_home_stay_180: {
        id: 'mini_triangle_home_stay_180',
        game: 'mini_triangle_home',
        title: 'Angle Finder',
        description: 'Stay on Triangle Home for 3 minutes',
        difficulty: 'Medium',
        icon: 'â±ï¸'
    },
    mini_triangle_home_stay_300: {
        id: 'mini_triangle_home_stay_300',
        game: 'mini_triangle_home',
        title: 'Perfect Path',
        description: 'Stay on Triangle Home for 5 minutes',
        difficulty: 'Hard',
        icon: 'ðŸ§­'
    },
    mini_racer_visit: {
        id: 'mini_racer_visit',
        game: 'mini_racer',
        title: 'Green Light',
        description: 'Open Racer',
        difficulty: 'Easy',
        icon: 'ðŸŽï¸'
    },
    mini_racer_stay_60: {
        id: 'mini_racer_stay_60',
        game: 'mini_racer',
        title: 'Warm-Up Lap',
        description: 'Stay on Racer for 60 seconds',
        difficulty: 'Easy',
        icon: 'â³'
    },
    mini_racer_stay_180: {
        id: 'mini_racer_stay_180',
        game: 'mini_racer',
        title: 'Steady Hands',
        description: 'Stay on Racer for 3 minutes',
        difficulty: 'Medium',
        icon: 'â±ï¸'
    },
    mini_racer_stay_300: {
        id: 'mini_racer_stay_300',
        game: 'mini_racer',
        title: 'Endurance Run',
        description: 'Stay on Racer for 5 minutes',
        difficulty: 'Hard',
        icon: 'ðŸ'
    },
    mini_pizza_undelivery_visit: {
        id: 'mini_pizza_undelivery_visit',
        game: 'mini_pizza_undelivery',
        title: 'Order Up',
        description: 'Open Pizza Undelivery',
        difficulty: 'Easy',
        icon: 'ðŸ•'
    },
    mini_pizza_undelivery_stay_60: {
        id: 'mini_pizza_undelivery_stay_60',
        game: 'mini_pizza_undelivery',
        title: 'Still Hot',
        description: 'Stay on Pizza Undelivery for 60 seconds',
        difficulty: 'Easy',
        icon: 'â³'
    },
    mini_pizza_undelivery_stay_180: {
        id: 'mini_pizza_undelivery_stay_180',
        game: 'mini_pizza_undelivery',
        title: 'Extra Cheese',
        description: 'Stay on Pizza Undelivery for 3 minutes',
        difficulty: 'Medium',
        icon: 'â±ï¸'
    },
    mini_pizza_undelivery_stay_300: {
        id: 'mini_pizza_undelivery_stay_300',
        game: 'mini_pizza_undelivery',
        title: 'Pizza Marathon',
        description: 'Stay on Pizza Undelivery for 5 minutes',
        difficulty: 'Hard',
        icon: 'ðŸ'
    },
    mini_nano_wirebot_visit: {
        id: 'mini_nano_wirebot_visit',
        game: 'mini_nano_wirebot',
        title: 'Tiny Tech',
        description: 'Open Nano Wirebot',
        difficulty: 'Easy',
        icon: 'ðŸ¤–'
    },
    mini_nano_wirebot_stay_60: {
        id: 'mini_nano_wirebot_stay_60',
        game: 'mini_nano_wirebot',
        title: 'Nano Focus',
        description: 'Stay on Nano Wirebot for 60 seconds',
        difficulty: 'Easy',
        icon: 'â³'
    },
    mini_nano_wirebot_stay_180: {
        id: 'mini_nano_wirebot_stay_180',
        game: 'mini_nano_wirebot',
        title: 'Precision Mode',
        description: 'Stay on Nano Wirebot for 3 minutes',
        difficulty: 'Medium',
        icon: 'â±ï¸'
    },
    mini_nano_wirebot_stay_300: {
        id: 'mini_nano_wirebot_stay_300',
        game: 'mini_nano_wirebot',
        title: 'Micro Master',
        description: 'Stay on Nano Wirebot for 5 minutes',
        difficulty: 'Hard',
        icon: 'ðŸ§ '
    },
    mini_off_the_line_visit: {
        id: 'mini_off_the_line_visit',
        game: 'mini_off_the_line',
        title: 'Off The Line',
        description: 'Open Off The Line',
        difficulty: 'Easy',
        icon: 'ðŸ§µ'
    },
    mini_off_the_line_stay_60: {
        id: 'mini_off_the_line_stay_60',
        game: 'mini_off_the_line',
        title: 'Don\'t Blink',
        description: 'Stay on Off The Line for 60 seconds',
        difficulty: 'Easy',
        icon: 'â³'
    },
    mini_off_the_line_stay_180: {
        id: 'mini_off_the_line_stay_180',
        game: 'mini_off_the_line',
        title: 'Laser Focus',
        description: 'Stay on Off The Line for 3 minutes',
        difficulty: 'Medium',
        icon: 'â±ï¸'
    },
    mini_off_the_line_stay_300: {
        id: 'mini_off_the_line_stay_300',
        game: 'mini_off_the_line',
        title: 'Unwavering',
        description: 'Stay on Off The Line for 5 minutes',
        difficulty: 'Hard',
        icon: 'ðŸ›¡ï¸'
    },
    mini_the_matr13k_visit: {
        id: 'mini_the_matr13k_visit',
        game: 'mini_the_matr13k',
        title: 'Follow The Code',
        description: 'Open The Matr13k',
        difficulty: 'Easy',
        icon: 'ðŸŸ©'
    },
    mini_the_matr13k_stay_60: {
        id: 'mini_the_matr13k_stay_60',
        game: 'mini_the_matr13k',
        title: 'Deeper In',
        description: 'Stay on The Matr13k for 60 seconds',
        difficulty: 'Easy',
        icon: 'â³'
    },
    mini_the_matr13k_stay_180: {
        id: 'mini_the_matr13k_stay_180',
        game: 'mini_the_matr13k',
        title: 'Pattern Reader',
        description: 'Stay on The Matr13k for 3 minutes',
        difficulty: 'Medium',
        icon: 'â±ï¸'
    },
    mini_the_matr13k_stay_300: {
        id: 'mini_the_matr13k_stay_300',
        game: 'mini_the_matr13k',
        title: 'Red Pill',
        description: 'Stay on The Matr13k for 5 minutes',
        difficulty: 'Hard',
        icon: 'ðŸ’Š'
    },
    mini_xx142_b2exe_visit: {
        id: 'mini_xx142_b2exe_visit',
        game: 'mini_xx142_b2exe',
        title: 'Executable',
        description: 'Open xx142-b2exe',
        difficulty: 'Easy',
        icon: 'ðŸ§ª'
    },
    mini_xx142_b2exe_stay_60: {
        id: 'mini_xx142_b2exe_stay_60',
        game: 'mini_xx142_b2exe',
        title: 'Run Time',
        description: 'Stay on xx142-b2exe for 60 seconds',
        difficulty: 'Easy',
        icon: 'â³'
    },
    mini_xx142_b2exe_stay_180: {
        id: 'mini_xx142_b2exe_stay_180',
        game: 'mini_xx142_b2exe',
        title: 'Debug Mode',
        description: 'Stay on xx142-b2exe for 3 minutes',
        difficulty: 'Medium',
        icon: 'â±ï¸'
    },
    mini_xx142_b2exe_stay_300: {
        id: 'mini_xx142_b2exe_stay_300',
        game: 'mini_xx142_b2exe',
        title: 'Full Compile',
        description: 'Stay on xx142-b2exe for 5 minutes',
        difficulty: 'Hard',
        icon: 'ðŸ…'
    },

    // â”€â”€ Phase 3A: Snake New Achievements â”€â”€
    snake_powerup_collector: {
        id: 'snake_powerup_collector',
        game: 'snake',
        title: 'Power Hungry',
        description: 'Collect 10 power-ups',
        difficulty: 'Medium',
        icon: 'ðŸ‡'
    },
    snake_invincible_master: {
        id: 'snake_invincible_master',
        game: 'snake',
        title: 'Untouchable',
        description: 'Use invincibility 5 times',
        difficulty: 'Hard',
        icon: 'ðŸŠ'
    },
    snake_obstacle_dodger: {
        id: 'snake_obstacle_dodger',
        game: 'snake',
        title: 'Obstacle Course',
        description: 'Survive 50 moves with obstacles on the field',
        difficulty: 'Hard',
        icon: 'ðŸ§±'
    },

    // â”€â”€ Phase 3B: Block Breaker New Achievements â”€â”€
    breaker_multi_ball: {
        id: 'breaker_multi_ball',
        game: 'breaker',
        title: 'Juggler',
        description: 'Keep 2+ balls alive for 30 seconds',
        difficulty: 'Hard',
        icon: 'ðŸ”µ'
    },
    breaker_laser_master: {
        id: 'breaker_laser_master',
        game: 'breaker',
        title: 'Laser Vision',
        description: 'Destroy 20 bricks with lasers',
        difficulty: 'Medium',
        icon: 'ðŸ”´'
    },
    breaker_diamond_breaker: {
        id: 'breaker_diamond_breaker',
        game: 'breaker',
        title: 'Diamond Crusher',
        description: 'Break a diamond brick',
        difficulty: 'Hard',
        icon: 'ðŸ’Ž'
    },

    // â”€â”€ Phase 3C: 2048 New Achievements â”€â”€
    merge_undo_saver: {
        id: 'merge_undo_saver',
        game: 'merge',
        title: 'Time Traveler',
        description: 'Use undo to save your game',
        difficulty: 'Easy',
        icon: 'âª'
    },
    merge_combo_king: {
        id: 'merge_combo_king',
        game: 'merge',
        title: 'Combo King',
        description: 'Trigger a 4-tile combo in one move',
        difficulty: 'Hard',
        icon: 'ðŸ‘‘'
    },
    merge_no_undo: {
        id: 'merge_no_undo',
        game: 'merge',
        title: 'Purist',
        description: 'Reach 2048 without using undo',
        difficulty: 'Legendary',
        icon: 'ðŸ†'
    },

    // â”€â”€ Phase 3D: Space Invaders New Achievements â”€â”€
    invaders_boss_killer: {
        id: 'invaders_boss_killer',
        game: 'invaders',
        title: 'Boss Slayer',
        description: 'Defeat a boss alien',
        difficulty: 'Hard',
        icon: 'ðŸ‘¹'
    },
    invaders_spread_master: {
        id: 'invaders_spread_master',
        game: 'invaders',
        title: 'Spread Eagle',
        description: 'Use spread shot 10 times',
        difficulty: 'Medium',
        icon: 'ðŸ”¥'
    },
    invaders_shield_keeper: {
        id: 'invaders_shield_keeper',
        game: 'invaders',
        title: 'Fortress',
        description: 'Complete a wave with 3 shield charges',
        difficulty: 'Hard',
        icon: 'ðŸ›¡ï¸'
    }
};

// These exports are required by achievements.js (used by the game routes).
// Failure mode (prod): ESM import aborts with "does not provide an export named ..."
// which prevents the game modules from running at all.
export const GAME_ORDER = ['snake', 'breaker', 'merge', 'invaders', 'site'];

export const GAME_LABELS = {
  snake: 'Snake',
  breaker: 'Block Breaker',
  merge: '2048',
  invaders: 'Space Invaders',
  site: 'Website'
};

export function buildAchievementIndex() {
  // achievements.js expects an id -> definition index for fast lookups.
  // ACHIEVEMENTS is authored as an object, so build defensively from values.
  // CRITICAL: Game files use colon format (snake:first_food) but defs use
  // underscore format (snake_first_food). Index both formats for compatibility.
  const index = {};
  for (const def of Object.values(ACHIEVEMENTS)) {
    if (def && typeof def.id === 'string') {
      index[def.id] = def;
      // Also index by colon format: snake_first_food -> snake:first_food
      const colonId = def.id.replace(/_/, ':');
      if (colonId !== def.id) index[colonId] = def;
    }
  }
  return index;
}
